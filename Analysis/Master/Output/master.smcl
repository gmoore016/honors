{smcl}
{com}{sf}{ul off}{txt}{.-}
      name:  {res}<unnamed>
       {txt}log:  {res}C:\Users\gmoore\desktop\honors\analysis\master\code\../Output/master.smcl
  {txt}log type:  {res}smcl
 {txt}opened on:  {res}28 Feb 2019, 23:49:10
{txt}
{com}. 
. set more off
{txt}
{com}. 
. //Import data from parent file (NLSY 79)
. cd ../../NLSY79ParentData/Code
{res}C:\Users\gmoore\desktop\honors\analysis\NLSY79ParentData\Code
{txt}
{com}. do ParImport
{txt}
{com}. import delimited ../Input/parInc.csv, clear case(preserve)
{res}{text}(30 vars, 12686 obs)
{com}. 
. 
. //Names family income variables
. rename R7006500 parInc0
{res}{txt}
{com}. rename R7703700 parInc2
{res}{txt}
{com}. rename R8496100 parInc4
{res}{txt}
{com}. rename T0987800 parInc6
{res}{txt}
{com}. rename T2210000 parInc8
{res}{txt}
{com}. rename T3107800 parInc10
{res}{txt}
{com}. rename T4112300 parInc12 
{res}{txt}
{com}. rename T5022600 parInc14 
{res}{txt}
{com}. 
. rename R0000100 mid
{res}{txt}
{com}. 
. //Names family variable assets
. //Bases missing years on last recorded assets
. //Top 2% of values topcoded each year by average of obscured values
. rename R6940103 assets0
{res}{txt}
{com}. gen assets2 = assets0
{txt}
{com}. rename R8378703 assets4
{res}{txt}
{com}. gen assets6 = assets4
{txt}
{com}. rename T2142702 assets8
{res}{txt}
{com}. gen assets10 = assets8
{txt}
{com}. rename T4045802 assets12
{res}{txt}
{com}. gen assets14 = assets12
{txt}
{com}. 
. //Names family home value
. //Bases missing years on last recorded value
. //Top values topcoded
. rename R6944402 homeVal0
{res}{txt}
{com}. gen homeVal2 = homeVal0
{txt}
{com}. rename R8379601 homeVal4
{res}{txt}
{com}. gen homeVal6 = homeVal4
{txt}
{com}. rename T2143900 homeVal8
{res}{txt}
{com}. gen homeVal10 = homeVal8
{txt}
{com}. rename T4047100 homeVal12
{res}{txt}
{com}. gen homeVal14 = homeVal12
{txt}
{com}. 
. //Renames marriage
. rename R6917500 married0
{res}{txt}
{com}. rename R7616100 married2
{res}{txt}
{com}. rename R8324800 married4
{res}{txt}
{com}. rename T0919900 married6
{res}{txt}
{com}. rename T2084600 married8
{res}{txt}
{com}. rename T3055100 married10
{res}{txt}
{com}. rename T3986700 married12
{res}{txt}
{com}. rename T4924000 married14
{res}{txt}
{com}. 
. //Adds birth month
. replace R0410300 = . if R0410300 < 0
{txt}(491 real changes made, 491 to missing)

{com}. replace R0410100 = . if R0410100 < 0
{txt}(491 real changes made, 491 to missing)

{com}. gen parDob = ym(1900 + R0410300, R0410100)
{txt}(491 missing values generated)

{com}. format parDob %tm
{txt}
{com}. drop R0410300 R0410100
{txt}
{com}. 
. keep parInc* assets* homeVal* married* mid parDob
{txt}
{com}. 
. reshape long parInc assets homeVal married, i(mid) j(year)
{txt}(note: j = 0 2 4 6 8 10 12 14)

Data{col 36}wide{col 43}->{col 48}long
{hline 77}
Number of obs.                 {res}   12686   {txt}->{res}  101488
{txt}Number of variables            {res}      34   {txt}->{res}       7
{txt}j variable (8 values)                     ->   {res}year
{txt}xij variables:
           {res}parInc0 parInc2 ... parInc14   {txt}->   {res}parInc
           assets0 assets2 ... assets14   {txt}->   {res}assets
        homeVal0 homeVal2 ... homeVal14   {txt}->   {res}homeVal
        married0 married2 ... married14   {txt}->   {res}married
{txt}{hline 77}

{com}. replace parInc = . if parInc < 0
{txt}(49007 real changes made, 49007 to missing)

{com}. replace assets = . if inlist(assets, -1, -2, -3, -4, -5)
{txt}(49616 real changes made, 49616 to missing)

{com}. replace homeVal = . if homeVal < 0
{txt}(40388 real changes made, 40388 to missing)

{com}. replace married = . if married < 0
{txt}(40772 real changes made, 40772 to missing)

{com}. 
. rename married momMarried
{res}{txt}
{com}. 
. sort mid year
{txt}
{com}. 
. save ../Output/ParData.dta, replace
{txt}file ../Output/ParData.dta saved

{com}. 
{txt}end of do-file

{com}. 
. //Import data from children file (NLSY 79 CYA)
. cd ../../NLSYChild79Data/Code
{res}C:\Users\gmoore\desktop\honors\analysis\NLSYChild79Data\Code
{txt}
{com}. do Import
{txt}
{com}. clear all
{txt}
{com}. 
. infile using ../Input/child.dct

{txt}infile dictionary {c -(}
  C0000100 "ID CODE OF CHILD"
  C0000200 "ID CODE OF MOTHER OF CHILD"
  C0005300 "RACE OF CHILD (FROM MOTHERS SCREENER 79)"
  C0005400 "SEX OF CHILD"
  C0005700 "DATE OF BIRTH OF CHILD - YEAR"
  Y1012100 "GRADE OR YR OF SCHOOL R IS CURRENTLY ENROLLED IN 2000"
  Y1025600 "FIELD OF STUDY CURR/MOST REC COLL -- NUMERIC CODE 2000"
  Y1026400 "AMT FULL-TIME COLLEGE TUITION & FEES (ENROLLED PT) 2000"
  Y1026500 "AMT FULL-TIME COLLEGE TUITION & FEES (ENROLLED FT) 2000"
  Y1026600 "REC LOAN TO COVER COST OF YEAR*S COLLEGE EXPENSES 2000"
  Y1026700 "AMT LOAN TO COVER COST OF YEAR*S COLLEGE EXPENSES 2000"
  Y1180501 "DATE OF CAPI INTERVIEW 2000"
  Y1180502 "DATE OF CAPI INTERVIEW 2000"
  Y1193000 "REGION OF RESIDENCE 2000"
  Y1254300 "GRADE OR YR OF SCHOOL R IS CURRENTLY ENROLLED IN 2002"
  Y1270800 "FIELD OF STUDY CURR/MOST REC COLL -- NUMERIC CODE 2002"
  Y1271600 "AMT FULL-TIME COLLEGE TUITION & FEES (ENROLLED PT) 2002"
  Y1271700 "AMT FULL-TIME COLLEGE TUITION & FEES (ENROLLED FT) 2002"
  Y1271800 "REC LOAN TO COVER COST OF YEAR*S COLLEGE EXPENSES 2002"
  Y1271900 "AMT LOAN TO COVER COST OF YEAR*S COLLEGE EXPENSES 2002"
  Y1421101 "DATE OF CAPI INTERVIEW 2002"
  Y1421102 "DATE OF CAPI INTERVIEW 2002"
  Y1435200 "REGION OF RESIDENCE 2002"
  Y1450201 "DATE OF CAPI INTERVIEW-MONTH 2004"
  Y1450202 "DATE OF CAPI INTERVIEW-YEAR 2004"
  Y1488000 "GRADE OR YR OF SCHOOL R IS CURRENTLY ENROLLED IN 2004"
  Y1504800 "FIELD OF STUDY CURR/MOST REC COLL -- NUMERIC CODE 2004"
  Y1505600 "AMT FULL-TIME COLLEGE TUITION & FEES (ENROLLED PT) 2004"
  Y1505700 "AMT FULL-TIME COLLEGE TUITION & FEES (ENROLLED FT) 2004"
  Y1505800 "REC LOAN TO COVER COST OF YEAR*S COLLEGE EXPENSES 2004"
  Y1505900 "AMT LOAN TO COVER COST OF YEAR*S COLLEGE EXPENSES 2004"
  Y1673400 "REGION OF RESIDENCE 2004"
  Y1695601 "DATE OF CAPI INTERVIEW-MONTH 2006"
  Y1695602 "DATE OF CAPI INTERVIEW-YEAR 2006"
  Y1737800 "GRADE OR YR OF SCHOOL R IS CURRENTLY ENROLLED IN 2006"
  Y1755100 "FIELD OF STUDY CURR/MOST REC COLL -- NUMERIC CODE 2006"
  Y1755900 "AMT FULL-TIME COLLEGE TUITION & FEES (ENROLLED PT) 2006"
  Y1756000 "AMT FULL-TIME COLLEGE TUITION & FEES (ENROLLED FT) 2006"
  Y1756100 "REC LOAN TO COVER COST OF YEAR*S COLLEGE EXPENSES 2006"
  Y1756200 "AMT LOAN TO COVER COST OF YEAR*S COLLEGE EXPENSES 2006"
  Y1949200 "REGION OF RESIDENCE 2006"
  Y1981601 "DATE OF CAPI INTERVIEW-MONTH 2008"
  Y1981602 "DATE OF CAPI INTERVIEW-YEAR 2008"
  Y2018600 "GRADE OR YR OF SCHOOL R IS CURRENTLY ENROLLED IN 2008"
  Y2036100 "FIELD OF STUDY CURR/MOST REC COLL -- NUMERIC CODE 2008"
  Y2036900 "AMT FULL-TIME COLLEGE TUITION & FEES (ENROLLED PT) 2008"
  Y2037000 "AMT FULL-TIME COLLEGE TUITION & FEES (ENROLLED FT) 2008"
  Y2037100 "REC LOAN TO COVER COST OF YEAR*S COLLEGE EXPENSES 2008"
  Y2037200 "AMT LOAN TO COVER COST OF YEAR*S COLLEGE EXPENSES 2008"
  Y2267000 "VERSION_R26 CHILD/YOUNG ADULT XRND"
  Y2267800 "REGION OF RESIDENCE 2008"
  Y2300401 "DATE OF CAPI INTERVIEW-MONTH 2010"
  Y2300402 "DATE OF CAPI INTERVIEW-YEAR 2010"
  Y2343700 "GRADE OR YR OF SCHOOL R IS CURRENTLY ENROLLED IN 2010"
  Y2360600 "FIELD OF STUDY CURR/MOST REC COLL -- NUMERIC CODE 2010"
  Y2361400 "AMT FULL-TIME COLLEGE TUITION & FEES (ENROLLED PT) 2010"
  Y2361500 "AMT FULL-TIME COLLEGE TUITION & FEES (ENROLLED FT) 2010"
  Y2361600 "REC LOAN TO COVER COST OF YEAR*S COLLEGE EXPENSES 2010"
  Y2361700 "AMT LOAN TO COVER COST OF YEAR*S COLLEGE EXPENSES 2010"
  Y2616700 "REGION OF RESIDENCE 2010"
  Y2633101 "DATE OF CAPI INTERVIEW-MONTH 2012"
  Y2633102 "DATE OF CAPI INTERVIEW-YEAR 2012"
  Y2673200 "GRADE OR YR OF SCHOOL R IS CURRENTLY ENROLLED IN 2012"
  Y2691100 "FIELD OF STUDY CURR/MOST REC COLL -- NUMERIC CODE 2012"
  Y2691900 "AMT FULL-TIME COLLEGE TUITION & FEES (ENROLLED PT) 2012"
  Y2692000 "AMT FULL-TIME COLLEGE TUITION & FEES (ENROLLED FT) 2012"
  Y2692100 "REC LOAN TO COVER COST OF YEAR*S COLLEGE EXPENSES 2012"
  Y2692200 "AMT LOAN TO COVER COST OF YEAR*S COLLEGE EXPENSES 2012"
  Y2967200 "REGION OF RESIDENCE 2012"
  Y2990501 "DATE OF CAPI INTERVIEW-MONTH 2014"
  Y2990502 "DATE OF CAPI INTERVIEW-YEAR 2014"
  Y3029600 "GRADE OR YR OF SCHOOL R IS CURRENTLY ENROLLED IN 2014"
  Y3046600 "FIELD OF STUDY CURR/MOST REC COLL -- NUMERIC CODE 2014"
  Y3047500 "AMOUNT OF FULL-TIME COLLEGE TUITION & FEES 2014"
  Y3047600 "REC LOAN TO COVER COST OF YEAR*S COLLEGE EXPENSES 2014"
  Y3047700 "AMT LOAN TO COVER COST OF YEAR*S COLLEGE EXPENSES 2014"
  Y3332700 "REGION OF RESIDENCE 2014"
{c )-}

(11521 observations read)

{com}. 
. //Unneeded documentation parameter
. drop Y2267000
{txt}
{com}. 
. //Define labels
. label define raceLab   1 "HISPANIC"  2 "BLACK"  3 "NON-BLACK, NON-HISPANIC"
{txt}
{com}. label define sexLab  1 "MALE"  2 "FEMALE"
{txt}
{com}. label define majLab  0 "NONE, NO MAJOR DECLARED YET"  1 "AGRICULTURE / NATURAL RESOURCES"  2 "ANTHROPOLOGY"  3 "ARCHAEOLOGY"  4 "ARCHITECTURE/ENVIRONMENTAL DESIGN"  5 "AREA STUDIES"  6 "BIOLOGICAL SCIENCES"  7 "BUSINESS"  8 "COMMUNICATIONS"  9 "COMPUTER/INFORMATION SCIENCE"  10 "CRIMINOLOGY"  11 "ECONOMICS"  12 "EDUCATION"  13 "ENGINEERING"  14 "ENGLISH"  15 "FINE AND APPLIED ARTS"  16 "FOREIGN LANGUAGES"  17 "HISTORY"  18 "HOME ECONOMICS"  19 "INTERDISCIPLINARY STUDIES"  20 "MATHEMATICS"  21 "NURSING"  22 "OTHER HEALTH PROFESSIONS"  23 "PHILOSOPHY"  24 "PHYSICAL SCIENCES"  25 "POLITICAL SCIENCE AND GOVERNMENT"  26 "PRE-DENTAL"  27 "PRE-LAW"  28 "PRE-MED"  29 "PRE-VET"  30 "PSYCHOLOGY"  31 "SOCIOLOGY"  32 "SOCIAL WORK"  33 "THEOLOGY/RELIGIOUS STUDIES"  99 "OTHER FIELD (SPECIFY)"
{txt}
{com}. label define ynLab  1 "Yes"  0 "No"
{txt}
{com}. label define regionLab 1 "NORTHEAST" 2 "NORTH CENTRAL" 3 "SOUTH" 4 "WEST"
{txt}
{com}. label define majTypeLab 0 "Humanities" 1 "STEM" 2 "Social Science" 3 "Professions" 4 "Business"
{txt}
{com}. label define gradeLab 1 "1ST GRADE"  2 "2ND GRADE"  3 "3RD GRADE"  4 "4TH GRADE"  5 "5TH GRADE"  6 "6TH GRADE"  7 "7TH GRADE"  8 "8TH GRADE"  9 "9TH GRADE"  10 "10TH GRADE"  11 "11TH GRADE"  12 "12TH GRADE"  13 "1ST YEAR COLLEGE"  14 "2ND YEAR COLLEGE"  15 "3RD YEAR COLLEGE"  16 "4TH YEAR COLLEGE"  17 "5TH YEAR COLLEGE"  18 "6TH YEAR COLLEGE"  19 "7TH YEAR COLLEGE"  20 "8TH YEAR COLLEGE OR MORE"  95 "UNGRADED"  0 "None"
{txt}
{com}. 
. //ID Numbers
. rename C0000100 cid
{res}{txt}
{com}. rename C0000200 mid
{res}{txt}
{com}. 
. //Demographics
. rename C0005300 race
{res}{txt}
{com}. label values race raceLab
{txt}
{com}. rename C0005400 sex
{res}{txt}
{com}. label values sex sexLab
{txt}
{com}. rename C0005700 dob
{res}{txt}
{com}. 
. //Year of study
. rename Y1012100 grade0
{res}{txt}
{com}. rename Y1254300 grade2
{res}{txt}
{com}. rename Y1488000 grade4
{res}{txt}
{com}. rename Y1737800 grade6
{res}{txt}
{com}. rename Y2018600 grade8
{res}{txt}
{com}. rename Y2343700 grade10
{res}{txt}
{com}. rename Y2673200 grade12
{res}{txt}
{com}. rename Y3029600 grade14
{res}{txt}
{com}. 
. label values grade* gradeLab
{txt}
{com}. 
. //Fields of study
. rename Y1025600 maj0
{res}{txt}
{com}. rename Y1270800 maj2
{res}{txt}
{com}. rename Y1504800 maj4
{res}{txt}
{com}. rename Y1755100 maj6
{res}{txt}
{com}. rename Y2036100 maj8
{res}{txt}
{com}. rename Y2360600 maj10
{res}{txt}
{com}. rename Y2691100 maj12
{res}{txt}
{com}. rename Y3046600 maj14
{res}{txt}
{com}. 
. label values maj* majLab
{txt}
{com}. label define vlY3046600   0 "NONE, NO MAJOR DECLARED YET"  54 "ACCOUNTING"  1 "AGRICULTURE/NATURAL RESOURCES"  34 "ANIMAL SCIENCE"  2 "ANTHROPOLOGY"  60 "APPLIED SCIENCES"  65 "APPLIED TECHNOLOGY (ELECTRICAL, HVAC, INDUSTRIAL MAINTENANCE, ETC.)"  4 "ARCHITECTURE/ENVIRONMENTAL DESIGN"  64 "AUTOMOTIVE/DIESEL TECHNOLOGY"  35 "BIOLOGY"  36 "BIOCHEMISTRY/PHYSIOLOGY/BIOMEDICAL SCIENCE"  7 "BUSINESS"  37 "CHEMISTRY"  39 "COGNITIVE SCIENCE/NEUROSCIENCE"  8 "COMMUNICATIONS"  9 "COMPUTER/INFORMATION SCIENCE/INFORMATION TECHNOLOGY"  38 "COSOMETOLOGY/AESTHETICS"  73 "COUNSELING"  10 "CRIMINOLOGY/CRIMINAL JUSTICE"  40 "CULINARY ARTS"  41 "DENTAL ASSISTANT"  11 "ECONOMICS"  12 "EDUCATION"  74 "EMERGENCY MEDICAL TECHNOLOGY"  13 "ENGINEERING"  14 "ENGLISH"  67 "ENVIRONMENTAL SCIENCES"  42 "FINANCE"  15 "FINE AND APPLIED ARTS/ART HISTORY"  16 "FOREIGN LANGUAGES"  75 "GENERAL EDUCATION"  43 "GENERAL STUDIES/LIBERAL ARTS"  56 "GEOGRAPHY"  44 "GRAPHIC DESIGN"  71 "HEALTH SCIENCES"  45 "HEALTHCARE ADMINISTRATION"  17 "HISTORY"  59 "HOSPITALITY/HOTEL MANAGEMENT"  18 "HUMAN ECOLOGY/HOME ECONOMICS"  46 "HUMAN RESOURCES"  19 "INTERDISCIPLINARY STUDIES"  55 "JOURNALISM/MEDIA STUDIES"  68 "KINESIOLOGY/SPORTS SCIENCE"  47 "MARKETING/ADVERTISING"  20 "MATHEMATICS"  48 "MEDICAL ASSISTANT"  72 "MEDICAL TECHNOLOGY"  49 "MUSIC"  21 "NURSING"  22 "OTHER HEALTH PROFESSIONS"  52 "OTHER SCIENCE"  62 "PARALEGAL STUDIES"  50 "PHARMACY/PRE-PHARMACY"  23 "PHILOSOPHY"  70 "PHYSICAL/OCCUPATIONAL THERAPY"  51 "PHYSICS"  25 "POLITICAL SCIENCE AND GOVERNMENT"  26 "PRE-DENTAL"  27 "PRE-LAW"  28 "PRE-MED"  29 "PRE-VET"  30 "PSYCHOLOGY"  63 "PUBLIC HEALTH/HUMAN SERVIES"  61 "PUBLIC POLICY/ADMINISTRATION"  58 "PUBLIC SAFETY"  57 "SECURITY/EMERGENCY MANAGEMENT"  32 "SOCIAL WORK"  31 "SOCIOLOGY"  53 "THEATRE/ MUSICAL THEATRE/DANCE"  33 "THEOLOGY/RELIGIOUS STUDIES"  69 "VETERINARY TECHNOLOGY"  66 "WELDING"  99 "OTHER FIELD (SPECIFY)"
{txt}
{com}. //Recoded majors in 2014
. label values maj14 vlY3046600
{txt}
{com}. 
. //Receive loan?
. rename Y1026600 recloan0
{res}{txt}
{com}. rename Y1271800 recloan2
{res}{txt}
{com}. rename Y1505800 recloan4
{res}{txt}
{com}. rename Y1756100 recloan6
{res}{txt}
{com}. rename Y2037100 recloan8
{res}{txt}
{com}. rename Y2361600 recloan10
{res}{txt}
{com}. rename Y2692100 recloan12
{res}{txt}
{com}. rename Y3047600 recloan14
{res}{txt}
{com}. 
. label values recloan* ynLab
{txt}
{com}. 
. //Region
. rename Y1193000 region0
{res}{txt}
{com}. rename Y1435200 region2
{res}{txt}
{com}. rename Y1673400 region4
{res}{txt}
{com}. rename Y1949200 region6
{res}{txt}
{com}. rename Y2267800 region8
{res}{txt}
{com}. rename Y2616700 region10
{res}{txt}
{com}. rename Y2967200 region12
{res}{txt}
{com}. rename Y3332700 region14
{res}{txt}
{com}. 
. label values region* regionLab
{txt}
{com}. 
. //Loan quantities
. rename Y1026700 loan0
{res}{txt}
{com}. rename Y1271900 loan2
{res}{txt}
{com}. rename Y1505900 loan4
{res}{txt}
{com}. rename Y1756200 loan6
{res}{txt}
{com}. rename Y2037200 loan8
{res}{txt}
{com}. rename Y2361700 loan10
{res}{txt}
{com}. rename Y2692200 loan12
{res}{txt}
{com}. rename Y3047700 loan14
{res}{txt}
{com}. 
. //Tuition
. rename Y1026400 fulltuition0
{res}{txt}
{com}. rename Y1026500 partialtuition0
{res}{txt}
{com}. rename Y1271600 fulltuition2
{res}{txt}
{com}. rename Y1271700 partialtuition2
{res}{txt}
{com}. rename Y1505600 fulltuition4
{res}{txt}
{com}. rename Y1505700 partialtuition4
{res}{txt}
{com}. rename Y1755900 fulltuition6
{res}{txt}
{com}. rename Y1756000 partialtuition6
{res}{txt}
{com}. rename Y2036900 fulltuition8
{res}{txt}
{com}. rename Y2037000 partialtuition8
{res}{txt}
{com}. rename Y2361400 fulltuition10
{res}{txt}
{com}. rename Y2361500 partialtuition10
{res}{txt}
{com}. rename Y2691900 fulltuition12
{res}{txt}
{com}. rename Y2692000 partialtuition12
{res}{txt}
{com}. 
. rename Y3047500 tuition14
{res}{txt}
{com}. 
. forvalues i = 0(2)12{c -(}
{txt}  2{com}.         assert fulltuition`i' < 0 | partialtuition`i' < 0
{txt}  3{com}.         gen tuition`i' = max(fulltuition`i', partialtuition`i')
{txt}  4{com}. {c )-}
{txt}
{com}. 
. 
. forval i = 0(2)10{c -(}
{txt}  2{com}.         replace recloan`i' = . if recloan`i' < 0
{txt}  3{com}. {c )-}
{txt}(11153 real changes made, 11153 to missing)
(10886 real changes made, 10886 to missing)
(10637 real changes made, 10637 to missing)
(10479 real changes made, 10479 to missing)
(10267 real changes made, 10267 to missing)
(10088 real changes made, 10088 to missing)

{com}. 
. //Interview dates
. //gen intDate0 = mdy(Y1180501, Y1180500, Y1180502)
. gen intDate0 = ym(Y1180502, Y1180501)
{txt}(8496 missing values generated)

{com}. //gen intDate2 = mdy(Y1421101, Y1421100, Y1421102)
. gen intDate2 = ym(Y1421102, Y1421101)
{txt}(7283 missing values generated)

{com}. //gen intDate4 = mdy(Y1450201, Y1450200, Y1450202)
. gen intDate4 = ym(Y1450202, Y1450201)
{txt}(6497 missing values generated)

{com}. //gen intDate6 = mdy(Y1695601, Y1695600, Y1695602)
. gen intDate6 = ym(Y1695602, Y1695601)
{txt}(5677 missing values generated)

{com}. //gen intDate8 = mdy(Y1981601, Y1981600, Y1981602)
. gen intDate8 = ym(Y1981602, Y1981601) 
{txt}(5216 missing values generated)

{com}. //gen intDate10 = mdy(Y2300401, Y2300400, Y2300402)
. gen intDate10 = ym(Y2300402, Y2300401)
{txt}(5419 missing values generated)

{com}. 
. gen intDate12 = ym(Y2633102, Y2633101)
{txt}(5713 missing values generated)

{com}. gen intDate14 = ym(Y2990502, Y2990501)
{txt}(5786 missing values generated)

{com}. format intDate* %tm
{txt}
{com}. drop Y1* Y2*
{txt}
{com}. 
. //Calculates how many siblings total
. duplicates tag mid, generate(sibs)

{p 0 4}{txt}Duplicates in terms of {res} mid{p_end}
{txt}
{com}. 
. //Get only observations with data on receiving loans
. drop if missing(recloan0) & missing(recloan2) ///
>         & missing(recloan4) & missing(recloan6) ///
>         & missing(recloan8) & missing(recloan10)
{txt}(8351 observations deleted)

{com}.         
. //Change to long data
. reshape long maj recloan loan region grade intDate tuition fulltuition partialtuition, i(cid) j(year)
{txt}(note: j = 0 2 4 6 8 10 12 14)
(note: fulltuition14 not found)
(note: partialtuition14 not found)

Data{col 36}wide{col 43}->{col 48}long
{hline 77}
Number of obs.                 {res}    3170   {txt}->{res}   25360
{txt}Number of variables            {res}      76   {txt}->{res}      16
{txt}j variable (8 values)                     ->   {res}year
{txt}xij variables:
                    {res}maj0 maj2 ... maj14   {txt}->   {res}maj
        recloan0 recloan2 ... recloan14   {txt}->   {res}recloan
                 loan0 loan2 ... loan14   {txt}->   {res}loan
           region0 region2 ... region14   {txt}->   {res}region
              grade0 grade2 ... grade14   {txt}->   {res}grade
        intDate0 intDate2 ... intDate14   {txt}->   {res}intDate
        tuition0 tuition2 ... tuition14   {txt}->   {res}tuition
fulltuition0 fulltuition2 ... fulltuition14{txt}->  {res}fulltuition
partialtuition0 partialtuition2 ... partialtuition14{txt}->{res}partialtuition
{txt}{hline 77}

{com}. 
. //Dummy for student in college; used to find concurrent siblings
. gen inCollege = grade >= 13
{txt}
{com}. duplicates tag year mid inCollege if inCollege > 0, generate(sibsInCollege)

{p 0 4}{txt}Duplicates in terms of {res} year mid inCollege{p_end}
{txt}
{com}. 
. //Code to Stata missings
. replace maj = . if maj < 0
{txt}(16163 real changes made, 16163 to missing)

{com}. replace loan = 0 if !recloan & !missing(recloan)
{txt}(3607 real changes made)

{com}. replace loan = . if loan < 0
{txt}(19063 real changes made, 19063 to missing)

{com}. replace region = . if region < 0
{txt}(6388 real changes made, 6388 to missing)

{com}. replace recloan = . if recloan < 0
{txt}(5257 real changes made, 5257 to missing)

{com}. replace grade = . if grade < 0
{txt}(14783 real changes made, 14783 to missing)

{com}. replace partialtuition = . if partialtuition < 0
{txt}(17757 real changes made, 17757 to missing)

{com}. replace fulltuition = . if fulltuition < 0
{txt}(21278 real changes made, 21278 to missing)

{com}. replace tuition = . if tuition < 0
{txt}(19683 real changes made, 19683 to missing)

{com}. 
. 
. //Generates dummy for after policy change
. gen cohort = (year >= 8)
{txt}
{com}. label define cohLab 0 "control" 1 "test"
{txt}
{com}. label values cohort cohLab
{txt}
{com}. 
. //Creates value of treatment
. //Freshmen received an increase of 3500-2625=875
. //Sophomores received an increase of 4500-3500=1000
. gen polImpact = 0
{txt}
{com}. //Students who are sophomores in the 2007-2008 school year receive only sophomore package
. replace polImpact = 1000 if  ((grade == 14 & inrange(intDate, ym(2007, 8), ym(2008, 8))) | ///
>          (grade == 15 & inrange(intDate, ym(2008, 8), ym(2009, 8))) | ///
>          (grade == 16 & inrange(intDate, ym(2009, 8), ym(2010, 8))) | ///
>          (grade == 17 & inrange(intDate, ym(2010, 8), ym(2011, 8))))
{txt}(538 real changes made)

{com}. 
. //Students who enter school after the policy change get full impact
. replace polImpact = 1875 if  ((grade == 13 & intDate > ym(2007, 8)) | ///
>          (grade == 14 & intDate > ym(2008, 8)) | ///
>          (grade == 15 & intDate > ym(2009, 8)) | ///
>          (grade == 16 & intDate > ym(2010, 8)) | ///
>          (grade == 17 & intDate > ym(2011, 8)))
{txt}(2541 real changes made)

{com}.         
. 
. //Places majors into bins
. gen majType = .
{txt}(25360 missing values generated)

{com}. //Humanities: Area Studies (5) English (14) Art (15) Language (16) History (17)
. //              Interdisciplinary Studies (19) Philosophy (23) Theology (33)
. replace majType = 0 if inlist(maj, 5, 14, 15, 16, 17, 19, 23, 33)
{txt}(525 real changes made)

{com}. //STEM: Agriculture (1) Architecture (4) Biology (6) CS(9) Engineering (13) 
. //              Math (20) Physics (24)
. replace majType = 1 if inlist(maj, 1, 4, 6, 9, 13, 20, 24)
{txt}(1413 real changes made)

{com}. //Social Science: Anthropology(2) Archaeology (3) Economics (11) Home Ec (18)
. //              Political Science (25) Psychology (30) Sociology (31)
. replace majType = 2 if inlist(maj, 2, 3, 11, 18, 25, 30, 31)
{txt}(703 real changes made)

{com}. //Professional: Communications (8) Criminology (10) Education (12)
. //              Nursing (21) Other Health (22) Pre-Dental/Law/Med/Vet (26-29)
. //              Social Work (32)
. replace majType = 3 if inlist(maj, 7, 8, 10, 12, 21, 22, 26, 27, 28, 29, 32)
{txt}(4461 real changes made)

{com}. //Business: Business (7)
. replace majType = 4 if maj == 7
{txt}(1412 real changes made)

{com}. 
. 
. //Tests if siblings are in college
. 
. 
. 
. 
. //assert missing(majType) == missing(maj) | maj == 0 | maj == 99
. 
. label values majType majTypeLab
{txt}
{com}. 
. gen fallSemester = halfyear(dofm(intDate)) - 1
{txt}(6257 missing values generated)

{com}. 
. keep if grade == 16
{txt}(24410 observations deleted)

{com}. 
. save ../Output/ChildData.dta, replace
{txt}file ../Output/ChildData.dta saved

{com}. 
. 
. 
{txt}end of do-file

{com}. 
. //Need many:one due to siblings
. //Assertion guarantees all children have parental incomes
. //Drop those women without children in college
. merge m:1 mid year using ../../NLSY79ParentData/Output/ParData.dta, assert(match using) nogen keep(match)
{res}
{txt}{col 5}Result{col 38}# of obs.
{col 5}{hline 41}
{col 5}not matched{col 30}{res}               0
{txt}{col 5}matched{col 30}{res}             950{txt}  
{col 5}{hline 41}

{com}. 
. //Saves merged file as input for need calculations, then outputs file
. //with completed need calcs
. cd ../../NeedCalc/Code
{res}C:\Users\gmoore\desktop\honors\analysis\NeedCalc\Code
{txt}
{com}. save ../Input/Merged.dta, replace
{txt}file ../Input/Merged.dta saved

{com}. do NeedCalc
{txt}
{com}. use ../Input/Merged.dta, clear
{txt}
{com}. //Available Income Calc
. 
. //Preliminary stats:
. 
. //Household is composed of:
. //Child and mother, plus siblings, plus spouse
. gen hhSize = 2 + sibs + momMarried
{txt}(70 missing values generated)

{com}. 
. //Box 1: Just parInc
. 
. //Box 2: Income Allowances
. tempvar incAllowance
{txt}
{com}. gen `incAllowance' = 0
{txt}
{com}. 
. //Social security allowance
. replace `incAllowance' = `incAllowance' + .0765 * parInc if parInc < 94200
{txt}(476 real changes made)

{com}. replace `incAllowance' = `incAllowance' + 7206.3 + 0.145 * (parInc - 94200) if parInc >= 94200
{txt}(465 real changes made, 195 to missing)

{com}. 
. //Income protection (line 12), aka table A3
. //Assumes parents are not also in college
. if hhSize == 2{c -(}
.         replace `incAllowance' = `incAllowance' + 15000
. {c )-}
{txt}
{com}. else if hhSize == 3{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 18680
.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 16130
.         {c )-}
. {c )-}
{txt}
{com}. else if hhSize == 4{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 23070
{txt}(755 real changes made)
{com}.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 20510
.         {c )-}
.         else if sibsInCollege == 2{c -(}
.                 replace `incAllowance' = `incAllowance' + 17950
.         {c )-}
. {c )-}
{txt}
{com}. else if hhSize == 5{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 27220
.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 24660
.         {c )-}
.         else if sibsInCollege == 2{c -(}
.                 replace `incAllowance' = `incAllowance' + 22100
.         {c )-}
.         else if sibsInCollege == 3{c -(}
.                 replace `incAllowance' = `incAllowance' + 19540
.         {c )-}
.         else if sibsInCollege == 4{c -(}
.                 replace `incAllowance' = `incAllowance' + 16980
.         {c )-}
. {c )-}
{txt}
{com}. else if hhSize >= 6{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 31840
.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 29280
.         {c )-}
.         else if sibsInCollege == 2{c -(}
.                 replace `incAllowance' = `incAllowance' + 26720
.         {c )-}
.         else if sibsInCollege == 3{c -(}
.                 replace `incAllowance' = `incAllowance' + 24160
.         {c )-}
.         else if sibsInCollege == 4{c -(}
.                 replace `incAllowance' = `incAllowance' + 21600
.         {c )-}
.         else if sibsInCollege == 5{c -(}
.                 replace `incAllowance' = `incAllowance' + 21600 - 2550
.         {c )-}
.         else if sibsInCollege >= 6{c -(}
.                 replace `incAllowance' = 21600 - (sibsInCollege - 6) * 2550
.         {c )-}
.         `incAllowance' = `incAllowance' + (hhSize - 6) * 3590
. {c )-}
{txt}
{com}. 
. //Single-parent deducation (line 13)
. replace `incAllowance' = `incAllowance' + min(3200, .35 * parInc) if !momMarried
{txt}(241 real changes made)

{com}. 
. 
. //Box 3
. tempvar availInc
{txt}
{com}. gen `availInc' = parInc - `incAllowance'
{txt}(195 missing values generated)

{com}. 
. 
. //Box 4
. tempvar availAssets
{txt}
{com}. gen `availAssets' = max(0, 0.12 * (assets - homeVal))
{txt}
{com}. 
. 
. //Box 5
. tempvar resources
{txt}
{com}. gen `resources' = `availInc' + `availAssets'
{txt}(195 missing values generated)

{com}. 
. tempvar grossCont
{txt}
{com}. gen `grossCont' = .
{txt}(950 missing values generated)

{com}. replace `grossCont' = -750 if `resources' < -3409
{txt}(104 real changes made)

{com}. replace `grossCont' = .22 * `availInc' if inrange(`resources', -3409, 13400)
{txt}(93 real changes made)

{com}. replace `grossCont' = 2948 + .25 * (`resources' - 13400) if inrange(`resources', 13401, 16800)
{txt}(25 real changes made)

{com}. replace `grossCont' = 3798 + .29 * (`resources' - 16800) if inrange(`resources', 16801, 20200)
{txt}(18 real changes made)

{com}. replace `grossCont' = 4784 + .34 * (`resources' - 20200) if inrange(`resources', 20201, 23700)
{txt}(16 real changes made)

{com}. replace `grossCont' = 5974 + .40 * (`resources' - 23700) if inrange(`resources', 23701, 27100)
{txt}(18 real changes made)

{com}. replace `grossCont' = 7334 + .47 * (`resources' - 27100) if `resources' >= 27101
{txt}(481 real changes made)

{com}. 
. replace `grossCont' = max(`grossCont', 0)
{txt}(324 real changes made)

{com}. 
. gen efc = `grossCont' / sibsInColl
{txt}(645 missing values generated)

{com}. 
. //If stopped at line 3
. replace efc = 0 if parInc < 20000
{txt}(67 real changes made)

{com}. 
. //Need
. gen need = tuition - efc
{txt}(612 missing values generated)

{com}. //replace need = 0 if need < 0
. 
. //Cap dummies
. gen atCap = 0 if !missing(need)
{txt}(612 missing values generated)

{com}. replace atCap = 1 if need >= 5500 & !missing(need)
{txt}(107 real changes made)

{com}. 
. //Drops temp variables (somehow not automatic?)
. drop __*
{txt}
{com}. 
. save ../Output/Need.dta, replace
{txt}file ../Output/Need.dta saved

{com}. 
{txt}end of do-file

{com}. 
. /*
> cd ../../Tables/Code
> do tables
> */
. 
. cd ../../Regressions/Code
{res}C:\Users\gmoore\desktop\honors\analysis\Regressions\Code
{txt}
{com}. do regs
{txt}
{com}. use ../../NeedCalc/Output/Need.dta, clear
{txt}
{com}. 
. //Linear time trend
. tobit loan atCap##c.polImpact need intDate i.fall i.race i.sex i.region if inrange(year, 8, 12), ll
{res}
{txt}Tobit regression{col 51}Number of obs{col 67}= {res}       191
{txt}{col 51}LR chi2({res}12{txt}){col 67}= {res}     37.08
{txt}{col 51}Prob > chi2{col 67}= {res}    0.0002
{txt}Log likelihood = {res}-1135.4587{txt}{col 51}Pseudo R2{col 67}= {res}    0.0161

{txt}{hline 25}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}                    loan{col 26}{c |}      Coef.{col 38}   Std. Err.{col 50}      t{col 58}   P>|t|{col 66}     [95% Con{col 79}f. Interval]
{hline 25}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 17}1.atCap {c |}{col 26}{res}{space 2} 365.7193{col 38}{space 2} 2747.683{col 49}{space 1}    0.13{col 58}{space 3}0.894{col 66}{space 4}-5056.299{col 79}{space 3} 5787.738
{txt}{space 15}polImpact {c |}{col 26}{res}{space 2}-2.118942{col 38}{space 2} 4.386204{col 49}{space 1}   -0.48{col 58}{space 3}0.630{col 66}{space 4}-10.77426{col 79}{space 3} 6.536378
{txt}{space 24} {c |}
{space 7}atCap#c.polImpact {c |}
{space 22}1  {c |}{col 26}{res}{space 2} 1.273193{col 38}{space 2} 2.132897{col 49}{space 1}    0.60{col 58}{space 3}0.551{col 66}{space 4}-2.935664{col 79}{space 3}  5.48205
{txt}{space 24} {c |}
{space 20}need {c |}{col 26}{res}{space 2} .1164893{col 38}{space 2} .0380139{col 49}{space 1}    3.06{col 58}{space 3}0.003{col 66}{space 4} .0414763{col 79}{space 3} .1915024
{txt}{space 17}intDate {c |}{col 26}{res}{space 2} 101.1579{col 38}{space 2}   155.74{col 49}{space 1}    0.65{col 58}{space 3}0.517{col 66}{space 4}-206.1647{col 79}{space 3} 408.4804
{txt}{space 10}1.fallSemester {c |}{col 26}{res}{space 2}-299.1045{col 38}{space 2} 1762.986{col 49}{space 1}   -0.17{col 58}{space 3}0.865{col 66}{space 4}-3778.014{col 79}{space 3} 3179.805
{txt}{space 24} {c |}
{space 20}race {c |}
{space 18}BLACK  {c |}{col 26}{res}{space 2} 2081.635{col 38}{space 2} 2322.386{col 49}{space 1}    0.90{col 58}{space 3}0.371{col 66}{space 4}-2501.142{col 79}{space 3} 6664.411
{txt}NON-BLACK, NON-HISPANIC  {c |}{col 26}{res}{space 2} 2599.554{col 38}{space 2} 2144.888{col 49}{space 1}    1.21{col 58}{space 3}0.227{col 66}{space 4}-1632.965{col 79}{space 3} 6832.074
{txt}{space 24} {c |}
{space 21}sex {c |}
{space 17}FEMALE  {c |}{col 26}{res}{space 2} 1317.073{col 38}{space 2}  1446.97{col 49}{space 1}    0.91{col 58}{space 3}0.364{col 66}{space 4} -1538.24{col 79}{space 3} 4172.386
{txt}{space 24} {c |}
{space 18}region {c |}
{space 10}NORTH CENTRAL  {c |}{col 26}{res}{space 2}-2795.865{col 38}{space 2}  2357.72{col 49}{space 1}   -1.19{col 58}{space 3}0.237{col 66}{space 4}-7448.366{col 79}{space 3} 1856.636
{txt}{space 18}SOUTH  {c |}{col 26}{res}{space 2}-1555.988{col 38}{space 2}  2347.58{col 49}{space 1}   -0.66{col 58}{space 3}0.508{col 66}{space 4} -6188.48{col 79}{space 3} 3076.505
{txt}{space 19}WEST  {c |}{col 26}{res}{space 2}-6404.725{col 38}{space 2} 2846.921{col 49}{space 1}   -2.25{col 58}{space 3}0.026{col 66}{space 4}-12022.57{col 79}{space 3}-786.8816
{txt}{space 24} {c |}
{space 19}_cons {c |}{col 26}{res}{space 2}-58000.44{col 38}{space 2} 90003.85{col 49}{space 1}   -0.64{col 58}{space 3}0.520{col 66}{space 4}-235605.5{col 79}{space 3} 119604.6
{txt}{hline 25}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
                  /sigma {c |}{col 26}{res}{space 2} 8751.533{col 38}{space 2} 661.5182{col 66}{space 4} 7446.155{col 79}{space 3} 10056.91
{txt}{hline 25}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
  Obs. summary:{col 18}{res}       88{col 28}{txt} left-censored observations at loan<={res}0
{txt}{col 18}{res}      103{col 28}{txt}    uncensored observations
{col 18}{res}        0{col 28}{txt}right-censored observations

{com}. 
. //Dummied time trend
. tobit loan atCap##c.polImpact need i.year i.fall i.race i.sex i.region if inrange(year, 8, 12), ll
{res}
{txt}Tobit regression{col 51}Number of obs{col 67}= {res}       191
{txt}{col 51}LR chi2({res}13{txt}){col 67}= {res}     38.51
{txt}{col 51}Prob > chi2{col 67}= {res}    0.0002
{txt}Log likelihood = {res}-1134.7431{txt}{col 51}Pseudo R2{col 67}= {res}    0.0167

{txt}{hline 25}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}                    loan{col 26}{c |}      Coef.{col 38}   Std. Err.{col 50}      t{col 58}   P>|t|{col 66}     [95% Con{col 79}f. Interval]
{hline 25}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 17}1.atCap {c |}{col 26}{res}{space 2} 23.44005{col 38}{space 2} 2763.785{col 49}{space 1}    0.01{col 58}{space 3}0.993{col 66}{space 4}-5430.561{col 79}{space 3} 5477.441
{txt}{space 15}polImpact {c |}{col 26}{res}{space 2}-9.018187{col 38}{space 2}  7.66756{col 49}{space 1}   -1.18{col 58}{space 3}0.241{col 66}{space 4} -24.1492{col 79}{space 3} 6.112829
{txt}{space 24} {c |}
{space 7}atCap#c.polImpact {c |}
{space 22}1  {c |}{col 26}{res}{space 2} 1.748973{col 38}{space 2} 2.183162{col 49}{space 1}    0.80{col 58}{space 3}0.424{col 66}{space 4}-2.559237{col 79}{space 3} 6.057184
{txt}{space 24} {c |}
{space 20}need {c |}{col 26}{res}{space 2} .1155075{col 38}{space 2} .0380432{col 49}{space 1}    3.04{col 58}{space 3}0.003{col 66}{space 4} .0404337{col 79}{space 3} .1905812
{txt}{space 24} {c |}
{space 20}year {c |}
{space 21}10  {c |}{col 26}{res}{space 2} 10299.47{col 38}{space 2}  7860.68{col 49}{space 1}    1.31{col 58}{space 3}0.192{col 66}{space 4}-5212.649{col 79}{space 3} 25811.58
{txt}{space 21}12  {c |}{col 26}{res}{space 2} 17504.48{col 38}{space 2} 14021.08{col 49}{space 1}    1.25{col 58}{space 3}0.214{col 66}{space 4}-10164.45{col 79}{space 3} 45173.41
{txt}{space 24} {c |}
{space 10}1.fallSemester {c |}{col 26}{res}{space 2}  562.185{col 38}{space 2} 1751.356{col 49}{space 1}    0.32{col 58}{space 3}0.749{col 66}{space 4}-2893.907{col 79}{space 3} 4018.277
{txt}{space 24} {c |}
{space 20}race {c |}
{space 18}BLACK  {c |}{col 26}{res}{space 2}  2386.42{col 38}{space 2} 2328.253{col 49}{space 1}    1.02{col 58}{space 3}0.307{col 66}{space 4} -2208.11{col 79}{space 3} 6980.949
{txt}NON-BLACK, NON-HISPANIC  {c |}{col 26}{res}{space 2} 2757.809{col 38}{space 2} 2151.957{col 49}{space 1}    1.28{col 58}{space 3}0.202{col 66}{space 4}-1488.821{col 79}{space 3} 7004.439
{txt}{space 24} {c |}
{space 21}sex {c |}
{space 17}FEMALE  {c |}{col 26}{res}{space 2} 1465.412{col 38}{space 2} 1455.544{col 49}{space 1}    1.01{col 58}{space 3}0.315{col 66}{space 4}-1406.931{col 79}{space 3} 4337.755
{txt}{space 24} {c |}
{space 18}region {c |}
{space 10}NORTH CENTRAL  {c |}{col 26}{res}{space 2}-2602.043{col 38}{space 2}   2362.1{col 49}{space 1}   -1.10{col 58}{space 3}0.272{col 66}{space 4}-7263.366{col 79}{space 3} 2059.279
{txt}{space 18}SOUTH  {c |}{col 26}{res}{space 2}-1471.623{col 38}{space 2} 2344.745{col 49}{space 1}   -0.63{col 58}{space 3}0.531{col 66}{space 4}-6098.698{col 79}{space 3} 3155.451
{txt}{space 19}WEST  {c |}{col 26}{res}{space 2}-6136.788{col 38}{space 2} 2853.789{col 49}{space 1}   -2.15{col 58}{space 3}0.033{col 66}{space 4} -11768.4{col 79}{space 3}-505.1754
{txt}{space 24} {c |}
{space 19}_cons {c |}{col 26}{res}{space 2}  -462.43{col 38}{space 2} 3467.669{col 49}{space 1}   -0.13{col 58}{space 3}0.894{col 66}{space 4}-7305.462{col 79}{space 3} 6380.602
{txt}{hline 25}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
                  /sigma {c |}{col 26}{res}{space 2} 8731.908{col 38}{space 2} 659.7669{col 66}{space 4} 7429.936{col 79}{space 3} 10033.88
{txt}{hline 25}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
  Obs. summary:{col 18}{res}       88{col 28}{txt} left-censored observations at loan<={res}0
{txt}{col 18}{res}      103{col 28}{txt}    uncensored observations
{col 18}{res}        0{col 28}{txt}right-censored observations

{com}. 
{txt}end of do-file

{com}. 
. cd ../../Master/Code
{res}C:\Users\gmoore\desktop\honors\analysis\Master\Code
{txt}
{com}. save ../Output/Master.dta, replace
{txt}file ../Output/Master.dta saved

{com}. 
{txt}end of do-file

{com}. do "C:\Users\gmoore\AppData\Local\Temp\STD00000000.tmp"
{txt}
{com}. use ../Input/Merged.dta, clear
{err}{p 0 4 2}
file ../Input/Merged.dta
not found
{p_end}
{txt}{search r(601):r(601);}

end of do-file

{search r(601):r(601);}

{com}. ls
{txt}  <dir>   2/28/19 22:54  {res}.                 
{txt}  <dir>   2/28/19 22:54  {res}..                
{txt}   0.8k   2/28/19 22:54  {res}Master.do         

{com}. cd ..
{res}C:\Users\gmoore\desktop\honors\analysis\Master

{com}. cd ../needcalc
{res}C:\Users\gmoore\desktop\honors\analysis\needcalc

{com}. cd code
{res}C:\Users\gmoore\desktop\honors\analysis\needcalc\code

{com}. ls
{txt}  <dir>   2/28/19 23:50  {res}.                 
{txt}  <dir>   2/28/19 23:50  {res}..                
{txt}   3.6k   2/28/19 23:50  {res}NeedCalc.do       

{com}. do needcalc
{txt}
{com}. use ../Input/Merged.dta, clear
{txt}
{com}. //Available Income Calc
. 
. //Preliminary stats:
. 
. //Household is composed of:
. //Child and mother, plus siblings, plus spouse
. gen hhSize = 2 + sibs + momMarried
{txt}(70 missing values generated)

{com}. 
. //Mother's age
. gen mAge = (ym(2008, 1) - parDob) / 12
{txt}(15 missing values generated)

{com}. 
. //Box 1: Just parInc
. 
. //Box 2: Income Allowances
. tempvar incAllowance
{txt}
{com}. gen `incAllowance' = 0
{txt}
{com}. 
. //Social security allowance
. replace `incAllowance' = `incAllowance' + .0765 * parInc if parInc < 94200
{txt}(476 real changes made)

{com}. replace `incAllowance' = `incAllowance' + 7206.3 + 0.145 * (parInc - 94200) if parInc >= 94200
{txt}(465 real changes made, 195 to missing)

{com}. 
. //Income protection (line 12), aka table A3
. //Assumes parents are not also in college
. if hhSize == 2{c -(}
.         replace `incAllowance' = `incAllowance' + 15000
. {c )-}
{txt}
{com}. else if hhSize == 3{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 18680
.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 16130
.         {c )-}
. {c )-}
{txt}
{com}. else if hhSize == 4{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 23070
{txt}(755 real changes made)
{com}.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 20510
.         {c )-}
.         else if sibsInCollege == 2{c -(}
.                 replace `incAllowance' = `incAllowance' + 17950
.         {c )-}
. {c )-}
{txt}
{com}. else if hhSize == 5{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 27220
.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 24660
.         {c )-}
.         else if sibsInCollege == 2{c -(}
.                 replace `incAllowance' = `incAllowance' + 22100
.         {c )-}
.         else if sibsInCollege == 3{c -(}
.                 replace `incAllowance' = `incAllowance' + 19540
.         {c )-}
.         else if sibsInCollege == 4{c -(}
.                 replace `incAllowance' = `incAllowance' + 16980
.         {c )-}
. {c )-}
{txt}
{com}. else if hhSize >= 6{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 31840
.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 29280
.         {c )-}
.         else if sibsInCollege == 2{c -(}
.                 replace `incAllowance' = `incAllowance' + 26720
.         {c )-}
.         else if sibsInCollege == 3{c -(}
.                 replace `incAllowance' = `incAllowance' + 24160
.         {c )-}
.         else if sibsInCollege == 4{c -(}
.                 replace `incAllowance' = `incAllowance' + 21600
.         {c )-}
.         else if sibsInCollege == 5{c -(}
.                 replace `incAllowance' = `incAllowance' + 21600 - 2550
.         {c )-}
.         else if sibsInCollege >= 6{c -(}
.                 replace `incAllowance' = 21600 - (sibsInCollege - 6) * 2550
.         {c )-}
.         `incAllowance' = `incAllowance' + (hhSize - 6) * 3590
. {c )-}
{txt}
{com}. 
. //Single-parent deducation (line 13)
. replace `incAllowance' = `incAllowance' + min(3200, .35 * parInc) if !momMarried
{txt}(241 real changes made)

{com}. 
. 
. //Box 3
. tempvar availInc
{txt}
{com}. gen `availInc' = parInc - `incAllowance'
{txt}(195 missing values generated)

{com}. 
. 
. //Box 4
. tempvar availAssets
{txt}
{com}. gen `availAssets' = max(0, 0.12 * (assets - homeVal))
{txt}
{com}. 
. 
. //Box 5
. tempvar resources
{txt}
{com}. gen `resources' = `availInc' + `availAssets'
{txt}(195 missing values generated)

{com}. 
. tempvar grossCont
{txt}
{com}. gen `grossCont' = .
{txt}(950 missing values generated)

{com}. replace `grossCont' = -750 if `resources' < -3409
{txt}(104 real changes made)

{com}. replace `grossCont' = .22 * `availInc' if inrange(`resources', -3409, 13400)
{txt}(93 real changes made)

{com}. replace `grossCont' = 2948 + .25 * (`resources' - 13400) if inrange(`resources', 13401, 16800)
{txt}(25 real changes made)

{com}. replace `grossCont' = 3798 + .29 * (`resources' - 16800) if inrange(`resources', 16801, 20200)
{txt}(18 real changes made)

{com}. replace `grossCont' = 4784 + .34 * (`resources' - 20200) if inrange(`resources', 20201, 23700)
{txt}(16 real changes made)

{com}. replace `grossCont' = 5974 + .40 * (`resources' - 23700) if inrange(`resources', 23701, 27100)
{txt}(18 real changes made)

{com}. replace `grossCont' = 7334 + .47 * (`resources' - 27100) if `resources' >= 27101
{txt}(481 real changes made)

{com}. 
. replace `grossCont' = max(`grossCont', 0)
{txt}(324 real changes made)

{com}. 
. gen efc = `grossCont' / sibsInColl
{txt}(645 missing values generated)

{com}. 
. //If stopped at line 3
. replace efc = 0 if parInc < 20000
{txt}(67 real changes made)

{com}. 
. //Need
. gen need = tuition - efc
{txt}(612 missing values generated)

{com}. //replace need = 0 if need < 0
. 
. //Cap dummies
. gen atCap = 0 if !missing(need)
{txt}(612 missing values generated)

{com}. replace atCap = 1 if need >= 5500 & !missing(need)
{txt}(107 real changes made)

{com}. 
. //Drops temp variables (somehow not automatic?)
. drop __*
{txt}
{com}. 
. save ../Output/Need.dta, replace
{txt}file ../Output/Need.dta saved

{com}. 
{txt}end of do-file

{com}. do "C:\Users\gmoore\Desktop\honors\Analysis\NeedCalc\Code\NeedCalc.do"
{txt}
{com}. use ../Input/Merged.dta, clear
{txt}
{com}. //Available Income Calc
. 
. //Preliminary stats:
. 
. //Household is composed of:
. //Child and mother, plus siblings, plus spouse
. gen hhSize = 2 + sibs + momMarried
{txt}(70 missing values generated)

{com}. 
. //Mother's age
. gen mAge = (ym(2008, 1) - parDob) / 12
{txt}(15 missing values generated)

{com}. kill
{err}unrecognized command:  kill
{txt}{search r(199):r(199);}

end of do-file

{search r(199):r(199);}

{com}. do "C:\Users\gmoore\Desktop\honors\Analysis\NeedCalc\Code\NeedCalc.do"
{txt}
{com}. use ../Input/Merged.dta, clear
{txt}
{com}. //Available Income Calc
. 
. //Preliminary stats:
. 
. //Household is composed of:
. //Child and mother, plus siblings, plus spouse
. gen hhSize = 2 + sibs + momMarried
{txt}(70 missing values generated)

{com}. 
. //Mother's age
. gen mAge = floor((ym(2008, 1) - parDob) / 12)
{txt}(15 missing values generated)

{com}. kill
{err}unrecognized command:  kill
{txt}{search r(199):r(199);}

end of do-file

{search r(199):r(199);}

{com}. hist mAge
{txt}(bin={res}29{txt}, start={res}43{txt}, width={res}.27586207{txt})
{res}
{com}. do "C:\Users\gmoore\Desktop\honors\Analysis\NeedCalc\Code\NeedCalc.do"
{txt}
{com}. use ../Input/Merged.dta, clear
{txt}
{com}. //Available Income Calc
. 
. //Preliminary stats:
. 
. //Household is composed of:
. //Child and mother, plus siblings, plus spouse
. gen hhSize = 2 + sibs + momMarried
{txt}(70 missing values generated)

{com}. 
. //Mother's age
. gen mAge = floor((ym(2008, 1) - parDob) / 12)
{txt}(15 missing values generated)

{com}. 
. //Box 1: Just parInc
. 
. //Box 2: Income Allowances
. tempvar incAllowance
{txt}
{com}. gen `incAllowance' = 0
{txt}
{com}. 
. //Social security allowance
. replace `incAllowance' = `incAllowance' + .0765 * parInc if parInc < 94200
{txt}(476 real changes made)

{com}. replace `incAllowance' = `incAllowance' + 7206.3 + 0.145 * (parInc - 94200) if parInc >= 94200
{txt}(465 real changes made, 195 to missing)

{com}. 
. //Income protection (line 12), aka table A3
. //Assumes parents are not also in college
. if hhSize == 2{c -(}
.         replace `incAllowance' = `incAllowance' + 15000
. {c )-}
{txt}
{com}. else if hhSize == 3{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 18680
.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 16130
.         {c )-}
. {c )-}
{txt}
{com}. else if hhSize == 4{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 23070
{txt}(755 real changes made)
{com}.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 20510
.         {c )-}
.         else if sibsInCollege == 2{c -(}
.                 replace `incAllowance' = `incAllowance' + 17950
.         {c )-}
. {c )-}
{txt}
{com}. else if hhSize == 5{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 27220
.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 24660
.         {c )-}
.         else if sibsInCollege == 2{c -(}
.                 replace `incAllowance' = `incAllowance' + 22100
.         {c )-}
.         else if sibsInCollege == 3{c -(}
.                 replace `incAllowance' = `incAllowance' + 19540
.         {c )-}
.         else if sibsInCollege == 4{c -(}
.                 replace `incAllowance' = `incAllowance' + 16980
.         {c )-}
. {c )-}
{txt}
{com}. else if hhSize >= 6{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 31840
.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 29280
.         {c )-}
.         else if sibsInCollege == 2{c -(}
.                 replace `incAllowance' = `incAllowance' + 26720
.         {c )-}
.         else if sibsInCollege == 3{c -(}
.                 replace `incAllowance' = `incAllowance' + 24160
.         {c )-}
.         else if sibsInCollege == 4{c -(}
.                 replace `incAllowance' = `incAllowance' + 21600
.         {c )-}
.         else if sibsInCollege == 5{c -(}
.                 replace `incAllowance' = `incAllowance' + 21600 - 2550
.         {c )-}
.         else if sibsInCollege >= 6{c -(}
.                 replace `incAllowance' = 21600 - (sibsInCollege - 6) * 2550
.         {c )-}
.         `incAllowance' = `incAllowance' + (hhSize - 6) * 3590
. {c )-}
{txt}
{com}. 
. //Single-parent deducation (line 13)
. replace `incAllowance' = `incAllowance' + min(3200, .35 * parInc) if !momMarried
{txt}(241 real changes made)

{com}. 
. 
. //Box 3
. tempvar availInc
{txt}
{com}. gen `availInc' = parInc - `incAllowance'
{txt}(195 missing values generated)

{com}. 
. 
. //Box 4
. tempvar availAssets
{txt}
{com}. gen `availAssets' = assets - homeVal
{txt}(267 missing values generated)

{com}. //Table A5
. `availAssets' = . if missing(momMarried)
{err}unrecognized command:  __000002
{txt}{search r(199):r(199);}

end of do-file

{search r(199):r(199);}

{com}. ls
{txt}  <dir>   3/01/19  0:45  {res}.                 
{txt}  <dir>   3/01/19  0:45  {res}..                
{txt}   8.2k   3/01/19  0:45  {res}NeedCalc.do       

{com}. do NeedCalc
{txt}
{com}. use ../Input/Merged.dta, clear
{txt}
{com}. //Available Income Calc
. 
. //Preliminary stats:
. 
. //Household is composed of:
. //Child and mother, plus siblings, plus spouse
. gen hhSize = 2 + sibs + momMarried
{txt}(70 missing values generated)

{com}. 
. //Mother's age
. gen mAge = floor((ym(2008, 1) - parDob) / 12)
{txt}(15 missing values generated)

{com}. 
. //Box 1: Just parInc
. 
. //Box 2: Income Allowances
. tempvar incAllowance
{txt}
{com}. gen `incAllowance' = 0
{txt}
{com}. 
. //Social security allowance
. replace `incAllowance' = `incAllowance' + .0765 * parInc if parInc < 94200
{txt}(476 real changes made)

{com}. replace `incAllowance' = `incAllowance' + 7206.3 + 0.145 * (parInc - 94200) if parInc >= 94200
{txt}(465 real changes made, 195 to missing)

{com}. 
. //Income protection (line 12), aka table A3
. //Assumes parents are not also in college
. if hhSize == 2{c -(}
.         replace `incAllowance' = `incAllowance' + 15000
. {c )-}
{txt}
{com}. else if hhSize == 3{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 18680
.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 16130
.         {c )-}
. {c )-}
{txt}
{com}. else if hhSize == 4{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 23070
{txt}(755 real changes made)
{com}.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 20510
.         {c )-}
.         else if sibsInCollege == 2{c -(}
.                 replace `incAllowance' = `incAllowance' + 17950
.         {c )-}
. {c )-}
{txt}
{com}. else if hhSize == 5{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 27220
.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 24660
.         {c )-}
.         else if sibsInCollege == 2{c -(}
.                 replace `incAllowance' = `incAllowance' + 22100
.         {c )-}
.         else if sibsInCollege == 3{c -(}
.                 replace `incAllowance' = `incAllowance' + 19540
.         {c )-}
.         else if sibsInCollege == 4{c -(}
.                 replace `incAllowance' = `incAllowance' + 16980
.         {c )-}
. {c )-}
{txt}
{com}. else if hhSize >= 6{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 31840
.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 29280
.         {c )-}
.         else if sibsInCollege == 2{c -(}
.                 replace `incAllowance' = `incAllowance' + 26720
.         {c )-}
.         else if sibsInCollege == 3{c -(}
.                 replace `incAllowance' = `incAllowance' + 24160
.         {c )-}
.         else if sibsInCollege == 4{c -(}
.                 replace `incAllowance' = `incAllowance' + 21600
.         {c )-}
.         else if sibsInCollege == 5{c -(}
.                 replace `incAllowance' = `incAllowance' + 21600 - 2550
.         {c )-}
.         else if sibsInCollege >= 6{c -(}
.                 replace `incAllowance' = 21600 - (sibsInCollege - 6) * 2550
.         {c )-}
.         `incAllowance' = `incAllowance' + (hhSize - 6) * 3590
. {c )-}
{txt}
{com}. 
. //Single-parent deducation (line 13)
. replace `incAllowance' = `incAllowance' + min(3200, .35 * parInc) if !momMarried
{txt}(241 real changes made)

{com}. 
. 
. //Box 3
. tempvar availInc
{txt}
{com}. gen `availInc' = parInc - `incAllowance'
{txt}(195 missing values generated)

{com}. 
. 
. //Box 4
. tempvar availAssets
{txt}
{com}. gen `availAssets' = assets - homeVal
{txt}(267 missing values generated)

{com}. //Table A5
. `availAssets' = . if missing(momMarried)
{err}unrecognized command:  __000002
{txt}{search r(199):r(199);}

end of do-file

{search r(199):r(199);}

{com}. do "C:\Users\gmoore\AppData\Local\Temp\STD00000000.tmp"
{txt}
{com}. use ../Input/Merged.dta, clear
{txt}
{com}. //Available Income Calc
. 
. //Preliminary stats:
. 
. //Household is composed of:
. //Child and mother, plus siblings, plus spouse
. gen hhSize = 2 + sibs + momMarried
{txt}(70 missing values generated)

{com}. 
. //Mother's age
. gen mAge = floor((ym(2008, 1) - parDob) / 12)
{txt}(15 missing values generated)

{com}. 
. //Box 1: Just parInc
. 
. //Box 2: Income Allowances
. tempvar incAllowance
{txt}
{com}. gen `incAllowance' = 0
{txt}
{com}. 
. //Social security allowance
. replace `incAllowance' = `incAllowance' + .0765 * parInc if parInc < 94200
{txt}(476 real changes made)

{com}. replace `incAllowance' = `incAllowance' + 7206.3 + 0.145 * (parInc - 94200) if parInc >= 94200
{txt}(465 real changes made, 195 to missing)

{com}. 
. //Income protection (line 12), aka table A3
. //Assumes parents are not also in college
. if hhSize == 2{c -(}
.         replace `incAllowance' = `incAllowance' + 15000
. {c )-}
{txt}
{com}. else if hhSize == 3{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 18680
.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 16130
.         {c )-}
. {c )-}
{txt}
{com}. else if hhSize == 4{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 23070
{txt}(755 real changes made)
{com}.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 20510
.         {c )-}
.         else if sibsInCollege == 2{c -(}
.                 replace `incAllowance' = `incAllowance' + 17950
.         {c )-}
. {c )-}
{txt}
{com}. else if hhSize == 5{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 27220
.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 24660
.         {c )-}
.         else if sibsInCollege == 2{c -(}
.                 replace `incAllowance' = `incAllowance' + 22100
.         {c )-}
.         else if sibsInCollege == 3{c -(}
.                 replace `incAllowance' = `incAllowance' + 19540
.         {c )-}
.         else if sibsInCollege == 4{c -(}
.                 replace `incAllowance' = `incAllowance' + 16980
.         {c )-}
. {c )-}
{txt}
{com}. else if hhSize >= 6{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 31840
.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 29280
.         {c )-}
.         else if sibsInCollege == 2{c -(}
.                 replace `incAllowance' = `incAllowance' + 26720
.         {c )-}
.         else if sibsInCollege == 3{c -(}
.                 replace `incAllowance' = `incAllowance' + 24160
.         {c )-}
.         else if sibsInCollege == 4{c -(}
.                 replace `incAllowance' = `incAllowance' + 21600
.         {c )-}
.         else if sibsInCollege == 5{c -(}
.                 replace `incAllowance' = `incAllowance' + 21600 - 2550
.         {c )-}
.         else if sibsInCollege >= 6{c -(}
.                 replace `incAllowance' = 21600 - (sibsInCollege - 6) * 2550
.         {c )-}
.         `incAllowance' = `incAllowance' + (hhSize - 6) * 3590
. {c )-}
{txt}
{com}. 
. //Single-parent deducation (line 13)
. replace `incAllowance' = `incAllowance' + min(3200, .35 * parInc) if !momMarried
{txt}(241 real changes made)

{com}. 
. 
. //Box 3
. tempvar availInc
{txt}
{com}. gen `availInc' = parInc - `incAllowance'
{txt}(195 missing values generated)

{com}. 
. 
. //Box 4
. tempvar availAssets
{txt}
{com}. gen `availAssets' = assets - homeVal
{txt}(267 missing values generated)

{com}. //Table A5
. replace `availAssets' = . if missing(momMarried)
{txt}(9 real changes made, 9 to missing)

{com}. if momMarried & !missing(momMarried){c -(}
.         `availAssets' = `availAssets' - 0 if mAge <= 25
{err}unrecognized command:  __000002
{txt}{search r(199):r(199);}
{com}.         `availAssets' = `availAssets' - 2500 if mAge == 26
.         `availAssets' = `availAssets' - 5100 if mAge == 27
.         `availAssets' = `availAssets' - 7600 if mAge == 28
.         `availAssets' = `availAssets' - 10200 if mAge == 29
.         `availAssets' = `availAssets' - 12700 if mAge == 30
.         `availAssets' = `availAssets' - 15200 if mAge == 31
.         `availAssets' = `availAssets' - 17800 if mAge == 32
.         `availAssets' = `availAssets' - 20300 if mAge == 33
.         `availAssets' = `availAssets' - 22900 if mAge == 34
.         `availAssets' = `availAssets' - 25400 if mAge == 35
.         `availAssets' = `availAssets' - 27900 if mAge == 36
.         `availAssets' = `availAssets' - 30500 if mAge == 37
.         `availAssets' = `availAssets' - 33000 if mAge == 38
.         `availAssets' = `availAssets' - 35600 if mAge == 39
.         `availAssets' = `availAssets' - 38100 if mAge == 40
.         `availAssets' = `availAssets' - 39100 if mAge == 41
.         `availAssets' = `availAssets' - 40100 if mAge == 42
.         `availAssets' = `availAssets' - 41100 if mAge == 43
.         `availAssets' = `availAssets' - 42100 if mAge == 44
.         `availAssets' = `availAssets' - 43100 if mAge == 45
.         `availAssets' = `availAssets' - 44200 if mAge == 46
.         `availAssets' = `availAssets' - 45300 if mAge == 47
.         `availAssets' = `availAssets' - 46400 if mAge == 48
.         `availAssets' = `availAssets' - 47600 if mAge == 49
.         `availAssets' = `availAssets' - 48700 if mAge == 50
.         `availAssets' = `availAssets' - 50200 if mAge == 51
.         `availAssets' = `availAssets' - 51500 if mAge == 52
.         `availAssets' = `availAssets' - 53000 if mAge == 53
.         `availAssets' = `availAssets' - 54300 if mAge == 54
.         `availAssets' = `availAssets' - 55900 if mAge == 55
.         `availAssets' = `availAssets' - 57300 if mAge == 56
.         `availAssets' = `availAssets' - 59000 if mAge == 57
.         `availAssets' = `availAssets' - 60700 if mAge == 58
.         `availAssets' = `availAssets' - 62500 if mAge == 59
.         `availAssets' = `availAssets' - 64300 if mAge == 60
.         `availAssets' = `availAssets' - 66200 if mAge == 61
.         `availAssets' = `availAssets' - 68100 if mAge == 62
.         `availAssets' = `availAssets' - 70400 if mAge == 63
.         `availAssets' = `availAssets' - 72400 if mAge == 64
.         `availAssets' = `availAssets' - 74800 if mAge >= 65 & !missing(mAge)
.         `availAssets' = . if missing(mAge)
. {c )-}
{txt}{search r(199):r(199);}

end of do-file

{search r(199):r(199);}

{com}. do NeedCalc
{txt}
{com}. use ../Input/Merged.dta, clear
{txt}
{com}. //Available Income Calc
. 
. //Preliminary stats:
. 
. //Household is composed of:
. //Child and mother, plus siblings, plus spouse
. gen hhSize = 2 + sibs + momMarried
{txt}(70 missing values generated)

{com}. 
. //Mother's age
. gen mAge = floor((ym(2008, 1) - parDob) / 12)
{txt}(15 missing values generated)

{com}. 
. //Box 1: Just parInc
. 
. //Box 2: Income Allowances
. tempvar incAllowance
{txt}
{com}. gen `incAllowance' = 0
{txt}
{com}. 
. //Social security allowance
. replace `incAllowance' = `incAllowance' + .0765 * parInc if parInc < 94200
{txt}(476 real changes made)

{com}. replace `incAllowance' = `incAllowance' + 7206.3 + 0.145 * (parInc - 94200) if parInc >= 94200
{txt}(465 real changes made, 195 to missing)

{com}. 
. //Income protection (line 12), aka table A3
. //Assumes parents are not also in college
. if hhSize == 2{c -(}
.         replace `incAllowance' = `incAllowance' + 15000
. {c )-}
{txt}
{com}. else if hhSize == 3{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 18680
.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 16130
.         {c )-}
. {c )-}
{txt}
{com}. else if hhSize == 4{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 23070
{txt}(755 real changes made)
{com}.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 20510
.         {c )-}
.         else if sibsInCollege == 2{c -(}
.                 replace `incAllowance' = `incAllowance' + 17950
.         {c )-}
. {c )-}
{txt}
{com}. else if hhSize == 5{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 27220
.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 24660
.         {c )-}
.         else if sibsInCollege == 2{c -(}
.                 replace `incAllowance' = `incAllowance' + 22100
.         {c )-}
.         else if sibsInCollege == 3{c -(}
.                 replace `incAllowance' = `incAllowance' + 19540
.         {c )-}
.         else if sibsInCollege == 4{c -(}
.                 replace `incAllowance' = `incAllowance' + 16980
.         {c )-}
. {c )-}
{txt}
{com}. else if hhSize >= 6{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 31840
.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 29280
.         {c )-}
.         else if sibsInCollege == 2{c -(}
.                 replace `incAllowance' = `incAllowance' + 26720
.         {c )-}
.         else if sibsInCollege == 3{c -(}
.                 replace `incAllowance' = `incAllowance' + 24160
.         {c )-}
.         else if sibsInCollege == 4{c -(}
.                 replace `incAllowance' = `incAllowance' + 21600
.         {c )-}
.         else if sibsInCollege == 5{c -(}
.                 replace `incAllowance' = `incAllowance' + 21600 - 2550
.         {c )-}
.         else if sibsInCollege >= 6{c -(}
.                 replace `incAllowance' = 21600 - (sibsInCollege - 6) * 2550
.         {c )-}
.         `incAllowance' = `incAllowance' + (hhSize - 6) * 3590
. {c )-}
{txt}
{com}. 
. //Single-parent deducation (line 13)
. replace `incAllowance' = `incAllowance' + min(3200, .35 * parInc) if !momMarried
{txt}(241 real changes made)

{com}. 
. 
. //Box 3
. tempvar availInc
{txt}
{com}. gen `availInc' = parInc - `incAllowance'
{txt}(195 missing values generated)

{com}. 
. 
. //Box 4
. tempvar availAssets
{txt}
{com}. gen `availAssets' = assets - homeVal
{txt}(267 missing values generated)

{com}. //Table A5
. replace `availAssets' = . if missing(momMarried)
{txt}(9 real changes made, 9 to missing)

{com}. if momMarried & !missing(momMarried){c -(}
.         replace `availAssets' = `availAssets' - 0 if mAge <= 25
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 2500 if mAge == 26
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 5100 if mAge == 27
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 7600 if mAge == 28
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 10200 if mAge == 29
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 12700 if mAge == 30
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 15200 if mAge == 31
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 17800 if mAge == 32
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 20300 if mAge == 33
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 22900 if mAge == 34
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 25400 if mAge == 35
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 27900 if mAge == 36
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 30500 if mAge == 37
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 33000 if mAge == 38
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 35600 if mAge == 39
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 38100 if mAge == 40
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 39100 if mAge == 41
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 40100 if mAge == 42
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 41100 if mAge == 43
{txt}(29 real changes made)
{com}.         replace `availAssets' = `availAssets' - 42100 if mAge == 44
{txt}(65 real changes made)
{com}.         replace `availAssets' = `availAssets' - 43100 if mAge == 45
{txt}(70 real changes made)
{com}.         replace `availAssets' = `availAssets' - 44200 if mAge == 46
{txt}(84 real changes made)
{com}.         replace `availAssets' = `availAssets' - 45300 if mAge == 47
{txt}(97 real changes made)
{com}.         replace `availAssets' = `availAssets' - 46400 if mAge == 48
{txt}(101 real changes made)
{com}.         replace `availAssets' = `availAssets' - 47600 if mAge == 49
{txt}(98 real changes made)
{com}.         replace `availAssets' = `availAssets' - 48700 if mAge == 50
{txt}(112 real changes made)
{com}.         replace `availAssets' = `availAssets' - 50200 if mAge == 51
{txt}(12 real changes made)
{com}.         replace `availAssets' = `availAssets' - 51500 if mAge == 52
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 53000 if mAge == 53
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 54300 if mAge == 54
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 55900 if mAge == 55
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 57300 if mAge == 56
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 59000 if mAge == 57
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 60700 if mAge == 58
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 62500 if mAge == 59
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 64300 if mAge == 60
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 66200 if mAge == 61
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 68100 if mAge == 62
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 70400 if mAge == 63
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 72400 if mAge == 64
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 74800 if mAge >= 65 & !missing(mAge)
{txt}(0 real changes made)
{com}.         replace `availAssets' = . if missing(mAge)
{txt}(6 real changes made, 6 to missing)
{com}. {c )-}
{txt}
{com}. if !momMarried{c -(}
.         replace `availAssets' = `availAssets' - 0 if mAge <= 25
.         replace `availAssets' = `availAssets' - 1000 if mAge == 26
.         replace `availAssets' = `availAssets' - 2100 if mAge == 27
.         replace `availAssets' = `availAssets' - 3100 if mAge == 28
.         replace `availAssets' = `availAssets' - 4200 if mAge == 29
.         replace `availAssets' = `availAssets' - 5200 if mAge == 30
.         replace `availAssets' = `availAssets' - 6300 if mAge == 31
.         replace `availAssets' = `availAssets' - 7300 if mAge == 32
.         replace `availAssets' = `availAssets' - 8400 if mAge == 33
.         replace `availAssets' = `availAssets' - 9400 if mAge == 34
.         replace `availAssets' = `availAssets' - 10500 if mAge == 35
.         replace `availAssets' = `availAssets' - 11500 if mAge == 36
.         replace `availAssets' = `availAssets' - 12600 if mAge == 37
.         replace `availAssets' = `availAssets' - 13600 if mAge == 38
.         replace `availAssets' = `availAssets' - 14700 if mAge == 39
.         replace `availAssets' = `availAssets' - 15700 if mAge == 40
.         replace `availAssets' = `availAssets' - 16100 if mAge == 41
.         replace `availAssets' = `availAssets' - 16400 if mAge == 42
.         replace `availAssets' = `availAssets' - 16800 if mAge == 43
.         replace `availAssets' = `availAssets' - 17200 if mAge == 44
.         replace `availAssets' = `availAssets' - 17500 if mAge == 45
.         replace `availAssets' = `availAssets' - 17900 if mAge == 46
.         replace `availAssets' = `availAssets' - 18300 if mAge == 47
.         replace `availAssets' = `availAssets' - 18800 if mAge == 48
.         replace `availAssets' = `availAssets' - 19200 if mAge == 49
.         replace `availAssets' = `availAssets' - 19700 if mAge == 50
.         replace `availAssets' = `availAssets' - 20100 if mAge == 51
.         replace `availAssets' = `availAssets' - 20500 if mAge == 52
.         replace `availAssets' = `availAssets' - 21000 if mAge == 53
.         replace `availAssets' = `availAssets' - 21600 if mAge == 54
.         replace `availAssets' = `availAssets' - 22100 if mAge == 55
.         replace `availAssets' = `availAssets' - 22700 if mAge == 56
.         replace `availAssets' = `availAssets' - 23200 if mAge == 57
.         replace `availAssets' = `availAssets' - 23900 if mAge == 58
.         replace `availAssets' = `availAssets' - 24400 if mAge == 59
.         replace `availAssets' = `availAssets' - 25100 if mAge == 60
.         replace `availAssets' = `availAssets' - 25700 if mAge == 61
.         replace `availAssets' = `availAssets' - 26400 if mAge == 62
.         replace `availAssets' = `availAssets' - 27200 if mAge == 63
.         replace `availAssets' = `availAssets' - 27900 if mAge == 64
.         replace `availAssets' = `availAssets' - 28700 if mAge >= 65 & !missing(mAge)
.         replace `availAssets' = . if missing(mAge)
. {c )-}
{txt}
{com}. 
. 
. gen `availAssets' = max(0, 0.12 * `availAssets')
{err}__000002 already defined
{txt}{search r(110):r(110);}

end of do-file

{search r(110):r(110);}

{com}. do "C:\Users\gmoore\AppData\Local\Temp\STD00000000.tmp"
{txt}
{com}. use ../Input/Merged.dta, clear
{txt}
{com}. 
{txt}end of do-file

{com}. do "C:\Users\gmoore\Desktop\honors\Analysis\NeedCalc\Code\NeedCalc.do"
{txt}
{com}. use ../Input/Merged.dta, clear
{txt}
{com}. //Available Income Calc
. 
. //Preliminary stats:
. 
. //Household is composed of:
. //Child and mother, plus siblings, plus spouse
. gen hhSize = 2 + sibs + momMarried
{txt}(70 missing values generated)

{com}. 
. //Mother's age
. gen mAge = floor((ym(2008, 1) - parDob) / 12)
{txt}(15 missing values generated)

{com}. 
. //Box 1: Just parInc
. 
. //Box 2: Income Allowances
. tempvar incAllowance
{txt}
{com}. gen `incAllowance' = 0
{txt}
{com}. 
. //Social security allowance
. replace `incAllowance' = `incAllowance' + .0765 * parInc if parInc < 94200
{txt}(476 real changes made)

{com}. replace `incAllowance' = `incAllowance' + 7206.3 + 0.145 * (parInc - 94200) if parInc >= 94200
{txt}(465 real changes made, 195 to missing)

{com}. 
. //Income protection (line 12), aka table A3
. //Assumes parents are not also in college
. if hhSize == 2{c -(}
.         replace `incAllowance' = `incAllowance' + 15000
. {c )-}
{txt}
{com}. else if hhSize == 3{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 18680
.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 16130
.         {c )-}
. {c )-}
{txt}
{com}. else if hhSize == 4{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 23070
{txt}(755 real changes made)
{com}.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 20510
.         {c )-}
.         else if sibsInCollege == 2{c -(}
.                 replace `incAllowance' = `incAllowance' + 17950
.         {c )-}
. {c )-}
{txt}
{com}. else if hhSize == 5{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 27220
.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 24660
.         {c )-}
.         else if sibsInCollege == 2{c -(}
.                 replace `incAllowance' = `incAllowance' + 22100
.         {c )-}
.         else if sibsInCollege == 3{c -(}
.                 replace `incAllowance' = `incAllowance' + 19540
.         {c )-}
.         else if sibsInCollege == 4{c -(}
.                 replace `incAllowance' = `incAllowance' + 16980
.         {c )-}
. {c )-}
{txt}
{com}. else if hhSize >= 6{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 31840
.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 29280
.         {c )-}
.         else if sibsInCollege == 2{c -(}
.                 replace `incAllowance' = `incAllowance' + 26720
.         {c )-}
.         else if sibsInCollege == 3{c -(}
.                 replace `incAllowance' = `incAllowance' + 24160
.         {c )-}
.         else if sibsInCollege == 4{c -(}
.                 replace `incAllowance' = `incAllowance' + 21600
.         {c )-}
.         else if sibsInCollege == 5{c -(}
.                 replace `incAllowance' = `incAllowance' + 21600 - 2550
.         {c )-}
.         else if sibsInCollege >= 6{c -(}
.                 replace `incAllowance' = 21600 - (sibsInCollege - 6) * 2550
.         {c )-}
.         `incAllowance' = `incAllowance' + (hhSize - 6) * 3590
. {c )-}
{txt}
{com}. 
. //Single-parent deducation (line 13)
. replace `incAllowance' = `incAllowance' + min(3200, .35 * parInc) if !momMarried
{txt}(241 real changes made)

{com}. 
. 
. //Box 3
. tempvar availInc
{txt}
{com}. gen `availInc' = parInc - `incAllowance'
{txt}(195 missing values generated)

{com}. 
. 
. //Box 4
. tempvar availAssets
{txt}
{com}. gen `availAssets' = assets - homeVal
{txt}(267 missing values generated)

{com}. //Table A5
. replace `availAssets' = . if missing(momMarried)
{txt}(9 real changes made, 9 to missing)

{com}. if momMarried & !missing(momMarried){c -(}
.         replace `availAssets' = `availAssets' - 0 if mAge <= 25
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 2500 if mAge == 26
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 5100 if mAge == 27
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 7600 if mAge == 28
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 10200 if mAge == 29
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 12700 if mAge == 30
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 15200 if mAge == 31
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 17800 if mAge == 32
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 20300 if mAge == 33
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 22900 if mAge == 34
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 25400 if mAge == 35
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 27900 if mAge == 36
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 30500 if mAge == 37
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 33000 if mAge == 38
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 35600 if mAge == 39
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 38100 if mAge == 40
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 39100 if mAge == 41
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 40100 if mAge == 42
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 41100 if mAge == 43
{txt}(29 real changes made)
{com}.         replace `availAssets' = `availAssets' - 42100 if mAge == 44
{txt}(65 real changes made)
{com}.         replace `availAssets' = `availAssets' - 43100 if mAge == 45
{txt}(70 real changes made)
{com}.         replace `availAssets' = `availAssets' - 44200 if mAge == 46
{txt}(84 real changes made)
{com}.         replace `availAssets' = `availAssets' - 45300 if mAge == 47
{txt}(97 real changes made)
{com}.         replace `availAssets' = `availAssets' - 46400 if mAge == 48
{txt}(101 real changes made)
{com}.         replace `availAssets' = `availAssets' - 47600 if mAge == 49
{txt}(98 real changes made)
{com}.         replace `availAssets' = `availAssets' - 48700 if mAge == 50
{txt}(112 real changes made)
{com}.         replace `availAssets' = `availAssets' - 50200 if mAge == 51
{txt}(12 real changes made)
{com}.         replace `availAssets' = `availAssets' - 51500 if mAge == 52
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 53000 if mAge == 53
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 54300 if mAge == 54
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 55900 if mAge == 55
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 57300 if mAge == 56
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 59000 if mAge == 57
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 60700 if mAge == 58
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 62500 if mAge == 59
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 64300 if mAge == 60
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 66200 if mAge == 61
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 68100 if mAge == 62
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 70400 if mAge == 63
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 72400 if mAge == 64
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 74800 if mAge >= 65 & !missing(mAge)
{txt}(0 real changes made)
{com}.         replace `availAssets' = . if missing(mAge)
{txt}(6 real changes made, 6 to missing)
{com}. {c )-}
{txt}
{com}. if !momMarried{c -(}
.         replace `availAssets' = `availAssets' - 0 if mAge <= 25
.         replace `availAssets' = `availAssets' - 1000 if mAge == 26
.         replace `availAssets' = `availAssets' - 2100 if mAge == 27
.         replace `availAssets' = `availAssets' - 3100 if mAge == 28
.         replace `availAssets' = `availAssets' - 4200 if mAge == 29
.         replace `availAssets' = `availAssets' - 5200 if mAge == 30
.         replace `availAssets' = `availAssets' - 6300 if mAge == 31
.         replace `availAssets' = `availAssets' - 7300 if mAge == 32
.         replace `availAssets' = `availAssets' - 8400 if mAge == 33
.         replace `availAssets' = `availAssets' - 9400 if mAge == 34
.         replace `availAssets' = `availAssets' - 10500 if mAge == 35
.         replace `availAssets' = `availAssets' - 11500 if mAge == 36
.         replace `availAssets' = `availAssets' - 12600 if mAge == 37
.         replace `availAssets' = `availAssets' - 13600 if mAge == 38
.         replace `availAssets' = `availAssets' - 14700 if mAge == 39
.         replace `availAssets' = `availAssets' - 15700 if mAge == 40
.         replace `availAssets' = `availAssets' - 16100 if mAge == 41
.         replace `availAssets' = `availAssets' - 16400 if mAge == 42
.         replace `availAssets' = `availAssets' - 16800 if mAge == 43
.         replace `availAssets' = `availAssets' - 17200 if mAge == 44
.         replace `availAssets' = `availAssets' - 17500 if mAge == 45
.         replace `availAssets' = `availAssets' - 17900 if mAge == 46
.         replace `availAssets' = `availAssets' - 18300 if mAge == 47
.         replace `availAssets' = `availAssets' - 18800 if mAge == 48
.         replace `availAssets' = `availAssets' - 19200 if mAge == 49
.         replace `availAssets' = `availAssets' - 19700 if mAge == 50
.         replace `availAssets' = `availAssets' - 20100 if mAge == 51
.         replace `availAssets' = `availAssets' - 20500 if mAge == 52
.         replace `availAssets' = `availAssets' - 21000 if mAge == 53
.         replace `availAssets' = `availAssets' - 21600 if mAge == 54
.         replace `availAssets' = `availAssets' - 22100 if mAge == 55
.         replace `availAssets' = `availAssets' - 22700 if mAge == 56
.         replace `availAssets' = `availAssets' - 23200 if mAge == 57
.         replace `availAssets' = `availAssets' - 23900 if mAge == 58
.         replace `availAssets' = `availAssets' - 24400 if mAge == 59
.         replace `availAssets' = `availAssets' - 25100 if mAge == 60
.         replace `availAssets' = `availAssets' - 25700 if mAge == 61
.         replace `availAssets' = `availAssets' - 26400 if mAge == 62
.         replace `availAssets' = `availAssets' - 27200 if mAge == 63
.         replace `availAssets' = `availAssets' - 27900 if mAge == 64
.         replace `availAssets' = `availAssets' - 28700 if mAge >= 65 & !missing(mAge)
.         replace `availAssets' = . if missing(mAge)
. {c )-}
{txt}
{com}. 
. 
. replace `availAssets' = max(0, 0.12 * `availAssets')
{txt}(950 real changes made)

{com}. 
. 
. //Box 5
. tempvar resources
{txt}
{com}. gen `resources' = `availInc' + `availAssets'
{txt}(195 missing values generated)

{com}. 
. tempvar grossCont
{txt}
{com}. gen `grossCont' = .
{txt}(950 missing values generated)

{com}. replace `grossCont' = -750 if `resources' < -3409
{txt}(107 real changes made)

{com}. replace `grossCont' = .22 * `availInc' if inrange(`resources', -3409, 13400)
{txt}(97 real changes made)

{com}. replace `grossCont' = 2948 + .25 * (`resources' - 13400) if inrange(`resources', 13401, 16800)
{txt}(22 real changes made)

{com}. replace `grossCont' = 3798 + .29 * (`resources' - 16800) if inrange(`resources', 16801, 20200)
{txt}(21 real changes made)

{com}. replace `grossCont' = 4784 + .34 * (`resources' - 20200) if inrange(`resources', 20201, 23700)
{txt}(18 real changes made)

{com}. replace `grossCont' = 5974 + .40 * (`resources' - 23700) if inrange(`resources', 23701, 27100)
{txt}(15 real changes made)

{com}. replace `grossCont' = 7334 + .47 * (`resources' - 27100) if `resources' >= 27101
{txt}(475 real changes made)

{com}. 
. replace `grossCont' = max(`grossCont', 0)
{txt}(324 real changes made)

{com}. 
. gen efc = `grossCont' / sibsInColl
{txt}(645 missing values generated)

{com}. 
. //If stopped at line 3
. replace efc = 0 if parInc < 20000
{txt}(67 real changes made)

{com}. 
. //Need
. gen need = tuition - efc
{txt}(612 missing values generated)

{com}. //replace need = 0 if need < 0
. 
. //Cap dummies
. gen atCap = 0 if !missing(need)
{txt}(612 missing values generated)

{com}. replace atCap = 1 if need >= 5500 & !missing(need)
{txt}(108 real changes made)

{com}. 
. //Drops temp variables (somehow not automatic?)
. drop __*
{txt}
{com}. 
. save ../Output/Need.dta, replace
{txt}file ../Output/Need.dta saved

{com}. 
{txt}end of do-file

{com}. hist need
{txt}(bin={res}18{txt}, start={res}-191538.97{txt}, width={res}13585.498{txt})
{res}
{com}. count if !momMarried
{res}  278

{com}. do "C:\Users\gmoore\Desktop\honors\Analysis\NeedCalc\Code\NeedCalc.do"
{txt}
{com}. use ../Input/Merged.dta, clear
{txt}
{com}. //Available Income Calc
. 
. //Preliminary stats:
. 
. //Household is composed of:
. //Child and mother, plus siblings, plus spouse
. gen hhSize = 2 + sibs + momMarried
{txt}(70 missing values generated)

{com}. 
. //Mother's age
. gen mAge = floor((ym(2008, 1) - parDob) / 12)
{txt}(15 missing values generated)

{com}. 
. //Box 1: Just parInc
. 
. //Box 2: Income Allowances
. tempvar incAllowance
{txt}
{com}. gen `incAllowance' = 0
{txt}
{com}. 
. //Social security allowance
. replace `incAllowance' = `incAllowance' + .0765 * parInc if parInc < 94200
{txt}(476 real changes made)

{com}. replace `incAllowance' = `incAllowance' + 7206.3 + 0.145 * (parInc - 94200) if parInc >= 94200
{txt}(465 real changes made, 195 to missing)

{com}. 
. //Income protection (line 12), aka table A3
. //Assumes parents are not also in college
. if hhSize == 2{c -(}
.         replace `incAllowance' = `incAllowance' + 15000
. {c )-}
{txt}
{com}. else if hhSize == 3{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 18680
.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 16130
.         {c )-}
. {c )-}
{txt}
{com}. else if hhSize == 4{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 23070
{txt}(755 real changes made)
{com}.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 20510
.         {c )-}
.         else if sibsInCollege == 2{c -(}
.                 replace `incAllowance' = `incAllowance' + 17950
.         {c )-}
. {c )-}
{txt}
{com}. else if hhSize == 5{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 27220
.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 24660
.         {c )-}
.         else if sibsInCollege == 2{c -(}
.                 replace `incAllowance' = `incAllowance' + 22100
.         {c )-}
.         else if sibsInCollege == 3{c -(}
.                 replace `incAllowance' = `incAllowance' + 19540
.         {c )-}
.         else if sibsInCollege == 4{c -(}
.                 replace `incAllowance' = `incAllowance' + 16980
.         {c )-}
. {c )-}
{txt}
{com}. else if hhSize >= 6{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 31840
.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 29280
.         {c )-}
.         else if sibsInCollege == 2{c -(}
.                 replace `incAllowance' = `incAllowance' + 26720
.         {c )-}
.         else if sibsInCollege == 3{c -(}
.                 replace `incAllowance' = `incAllowance' + 24160
.         {c )-}
.         else if sibsInCollege == 4{c -(}
.                 replace `incAllowance' = `incAllowance' + 21600
.         {c )-}
.         else if sibsInCollege == 5{c -(}
.                 replace `incAllowance' = `incAllowance' + 21600 - 2550
.         {c )-}
.         else if sibsInCollege >= 6{c -(}
.                 replace `incAllowance' = 21600 - (sibsInCollege - 6) * 2550
.         {c )-}
.         `incAllowance' = `incAllowance' + (hhSize - 6) * 3590
. {c )-}
{txt}
{com}. 
. //Single-parent deducation (line 13)
. replace `incAllowance' = `incAllowance' + min(3200, .35 * parInc) if !momMarried
{txt}(241 real changes made)

{com}. 
. 
. //Box 3
. tempvar availInc
{txt}
{com}. gen `availInc' = parInc - `incAllowance'
{txt}(195 missing values generated)

{com}. 
. 
. //Box 4
. tempvar availAssets
{txt}
{com}. gen `availAssets' = assets - homeVal
{txt}(267 missing values generated)

{com}. //Table A5
. replace `availAssets' = . if missing(momMarried)
{txt}(9 real changes made, 9 to missing)

{com}. if momMarried & !missing(momMarried){c -(}
.         replace `availAssets' = `availAssets' - 0 if mAge <= 25
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 2500 if mAge == 26
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 5100 if mAge == 27
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 7600 if mAge == 28
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 10200 if mAge == 29
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 12700 if mAge == 30
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 15200 if mAge == 31
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 17800 if mAge == 32
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 20300 if mAge == 33
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 22900 if mAge == 34
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 25400 if mAge == 35
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 27900 if mAge == 36
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 30500 if mAge == 37
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 33000 if mAge == 38
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 35600 if mAge == 39
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 38100 if mAge == 40
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 39100 if mAge == 41
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 40100 if mAge == 42
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 41100 if mAge == 43
{txt}(29 real changes made)
{com}.         replace `availAssets' = `availAssets' - 42100 if mAge == 44
{txt}(65 real changes made)
{com}.         replace `availAssets' = `availAssets' - 43100 if mAge == 45
{txt}(70 real changes made)
{com}.         replace `availAssets' = `availAssets' - 44200 if mAge == 46
{txt}(84 real changes made)
{com}.         replace `availAssets' = `availAssets' - 45300 if mAge == 47
{txt}(97 real changes made)
{com}.         replace `availAssets' = `availAssets' - 46400 if mAge == 48
{txt}(101 real changes made)
{com}.         replace `availAssets' = `availAssets' - 47600 if mAge == 49
{txt}(98 real changes made)
{com}.         replace `availAssets' = `availAssets' - 48700 if mAge == 50
{txt}(112 real changes made)
{com}.         replace `availAssets' = `availAssets' - 50200 if mAge == 51
{txt}(12 real changes made)
{com}.         replace `availAssets' = `availAssets' - 51500 if mAge == 52
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 53000 if mAge == 53
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 54300 if mAge == 54
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 55900 if mAge == 55
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 57300 if mAge == 56
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 59000 if mAge == 57
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 60700 if mAge == 58
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 62500 if mAge == 59
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 64300 if mAge == 60
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 66200 if mAge == 61
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 68100 if mAge == 62
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 70400 if mAge == 63
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 72400 if mAge == 64
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 74800 if mAge >= 65 & !missing(mAge)
{txt}(0 real changes made)
{com}.         replace `availAssets' = . if missing(mAge)
{txt}(6 real changes made, 6 to missing)
{com}. {c )-}
{txt}
{com}. if !momMarried{c -(}
.         display "THIS IS A TEST"
.         replace `availAssets' = `availAssets' - 0 if mAge <= 25
.         replace `availAssets' = `availAssets' - 1000 if mAge == 26
.         replace `availAssets' = `availAssets' - 2100 if mAge == 27
.         replace `availAssets' = `availAssets' - 3100 if mAge == 28
.         replace `availAssets' = `availAssets' - 4200 if mAge == 29
.         replace `availAssets' = `availAssets' - 5200 if mAge == 30
.         replace `availAssets' = `availAssets' - 6300 if mAge == 31
.         replace `availAssets' = `availAssets' - 7300 if mAge == 32
.         replace `availAssets' = `availAssets' - 8400 if mAge == 33
.         replace `availAssets' = `availAssets' - 9400 if mAge == 34
.         replace `availAssets' = `availAssets' - 10500 if mAge == 35
.         replace `availAssets' = `availAssets' - 11500 if mAge == 36
.         replace `availAssets' = `availAssets' - 12600 if mAge == 37
.         replace `availAssets' = `availAssets' - 13600 if mAge == 38
.         replace `availAssets' = `availAssets' - 14700 if mAge == 39
.         replace `availAssets' = `availAssets' - 15700 if mAge == 40
.         replace `availAssets' = `availAssets' - 16100 if mAge == 41
.         replace `availAssets' = `availAssets' - 16400 if mAge == 42
.         replace `availAssets' = `availAssets' - 16800 if mAge == 43
.         replace `availAssets' = `availAssets' - 17200 if mAge == 44
.         replace `availAssets' = `availAssets' - 17500 if mAge == 45
.         replace `availAssets' = `availAssets' - 17900 if mAge == 46
.         replace `availAssets' = `availAssets' - 18300 if mAge == 47
.         replace `availAssets' = `availAssets' - 18800 if mAge == 48
.         replace `availAssets' = `availAssets' - 19200 if mAge == 49
.         replace `availAssets' = `availAssets' - 19700 if mAge == 50
.         replace `availAssets' = `availAssets' - 20100 if mAge == 51
.         replace `availAssets' = `availAssets' - 20500 if mAge == 52
.         replace `availAssets' = `availAssets' - 21000 if mAge == 53
.         replace `availAssets' = `availAssets' - 21600 if mAge == 54
.         replace `availAssets' = `availAssets' - 22100 if mAge == 55
.         replace `availAssets' = `availAssets' - 22700 if mAge == 56
.         replace `availAssets' = `availAssets' - 23200 if mAge == 57
.         replace `availAssets' = `availAssets' - 23900 if mAge == 58
.         replace `availAssets' = `availAssets' - 24400 if mAge == 59
.         replace `availAssets' = `availAssets' - 25100 if mAge == 60
.         replace `availAssets' = `availAssets' - 25700 if mAge == 61
.         replace `availAssets' = `availAssets' - 26400 if mAge == 62
.         replace `availAssets' = `availAssets' - 27200 if mAge == 63
.         replace `availAssets' = `availAssets' - 27900 if mAge == 64
.         replace `availAssets' = `availAssets' - 28700 if mAge >= 65 & !missing(mAge)
.         replace `availAssets' = . if missing(mAge)
. {c )-}
{txt}
{com}. 
. 
. replace `availAssets' = max(0, 0.12 * `availAssets')
{txt}(950 real changes made)

{com}. 
. 
. //Box 5
. tempvar resources
{txt}
{com}. gen `resources' = `availInc' + `availAssets'
{txt}(195 missing values generated)

{com}. 
. tempvar grossCont
{txt}
{com}. gen `grossCont' = .
{txt}(950 missing values generated)

{com}. replace `grossCont' = -750 if `resources' < -3409
{txt}(107 real changes made)

{com}. replace `grossCont' = .22 * `availInc' if inrange(`resources', -3409, 13400)
{txt}(97 real changes made)

{com}. replace `grossCont' = 2948 + .25 * (`resources' - 13400) if inrange(`resources', 13401, 16800)
{txt}(22 real changes made)

{com}. replace `grossCont' = 3798 + .29 * (`resources' - 16800) if inrange(`resources', 16801, 20200)
{txt}(21 real changes made)

{com}. replace `grossCont' = 4784 + .34 * (`resources' - 20200) if inrange(`resources', 20201, 23700)
{txt}(18 real changes made)

{com}. replace `grossCont' = 5974 + .40 * (`resources' - 23700) if inrange(`resources', 23701, 27100)
{txt}(15 real changes made)

{com}. replace `grossCont' = 7334 + .47 * (`resources' - 27100) if `resources' >= 27101
{txt}(475 real changes made)

{com}. 
. replace `grossCont' = max(`grossCont', 0)
{txt}(324 real changes made)

{com}. 
. gen efc = `grossCont' / sibsInColl
{txt}(645 missing values generated)

{com}. 
. //If stopped at line 3
. replace efc = 0 if parInc < 20000
{txt}(67 real changes made)

{com}. 
. //Need
. gen need = tuition - efc
{txt}(612 missing values generated)

{com}. //replace need = 0 if need < 0
. 
. //Cap dummies
. gen atCap = 0 if !missing(need)
{txt}(612 missing values generated)

{com}. replace atCap = 1 if need >= 5500 & !missing(need)
{txt}(108 real changes made)

{com}. 
. //Drops temp variables (somehow not automatic?)
. drop __*
{txt}
{com}. 
. save ../Output/Need.dta, replace
{txt}file ../Output/Need.dta saved

{com}. 
{txt}end of do-file

{com}. do "C:\Users\gmoore\Desktop\honors\Analysis\NeedCalc\Code\NeedCalc.do"
{txt}
{com}. use ../Input/Merged.dta, clear
{txt}
{com}. //Available Income Calc
. 
. //Preliminary stats:
. 
. //Household is composed of:
. //Child and mother, plus siblings, plus spouse
. gen hhSize = 2 + sibs + momMarried
{txt}(70 missing values generated)

{com}. 
. //Mother's age
. gen mAge = floor((ym(2008, 1) - parDob) / 12)
{txt}(15 missing values generated)

{com}. 
. //Box 1: Just parInc
. 
. //Box 2: Income Allowances
. tempvar incAllowance
{txt}
{com}. gen `incAllowance' = 0
{txt}
{com}. 
. //Social security allowance
. replace `incAllowance' = `incAllowance' + .0765 * parInc if parInc < 94200
{txt}(476 real changes made)

{com}. replace `incAllowance' = `incAllowance' + 7206.3 + 0.145 * (parInc - 94200) if parInc >= 94200
{txt}(465 real changes made, 195 to missing)

{com}. 
. //Income protection (line 12), aka table A3
. //Assumes parents are not also in college
. if hhSize == 2{c -(}
.         replace `incAllowance' = `incAllowance' + 15000
. {c )-}
{txt}
{com}. else if hhSize == 3{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 18680
.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 16130
.         {c )-}
. {c )-}
{txt}
{com}. else if hhSize == 4{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 23070
{txt}(755 real changes made)
{com}.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 20510
.         {c )-}
.         else if sibsInCollege == 2{c -(}
.                 replace `incAllowance' = `incAllowance' + 17950
.         {c )-}
. {c )-}
{txt}
{com}. else if hhSize == 5{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 27220
.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 24660
.         {c )-}
.         else if sibsInCollege == 2{c -(}
.                 replace `incAllowance' = `incAllowance' + 22100
.         {c )-}
.         else if sibsInCollege == 3{c -(}
.                 replace `incAllowance' = `incAllowance' + 19540
.         {c )-}
.         else if sibsInCollege == 4{c -(}
.                 replace `incAllowance' = `incAllowance' + 16980
.         {c )-}
. {c )-}
{txt}
{com}. else if hhSize >= 6{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 31840
.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 29280
.         {c )-}
.         else if sibsInCollege == 2{c -(}
.                 replace `incAllowance' = `incAllowance' + 26720
.         {c )-}
.         else if sibsInCollege == 3{c -(}
.                 replace `incAllowance' = `incAllowance' + 24160
.         {c )-}
.         else if sibsInCollege == 4{c -(}
.                 replace `incAllowance' = `incAllowance' + 21600
.         {c )-}
.         else if sibsInCollege == 5{c -(}
.                 replace `incAllowance' = `incAllowance' + 21600 - 2550
.         {c )-}
.         else if sibsInCollege >= 6{c -(}
.                 replace `incAllowance' = 21600 - (sibsInCollege - 6) * 2550
.         {c )-}
.         `incAllowance' = `incAllowance' + (hhSize - 6) * 3590
. {c )-}
{txt}
{com}. 
. //Single-parent deducation (line 13)
. replace `incAllowance' = `incAllowance' + min(3200, .35 * parInc) if !momMarried
{txt}(241 real changes made)

{com}. 
. 
. //Box 3
. tempvar availInc
{txt}
{com}. gen `availInc' = parInc - `incAllowance'
{txt}(195 missing values generated)

{com}. 
. 
. //Box 4
. tempvar availAssets
{txt}
{com}. gen `availAssets' = assets - homeVal
{txt}(267 missing values generated)

{com}. //Table A5
. replace `availAssets' = . if missing(momMarried)
{txt}(9 real changes made, 9 to missing)

{com}. if momMarried & !missing(momMarried){c -(}
.         replace `availAssets' = `availAssets' - 0 if mAge <= 25
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 2500 if mAge == 26
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 5100 if mAge == 27
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 7600 if mAge == 28
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 10200 if mAge == 29
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 12700 if mAge == 30
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 15200 if mAge == 31
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 17800 if mAge == 32
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 20300 if mAge == 33
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 22900 if mAge == 34
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 25400 if mAge == 35
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 27900 if mAge == 36
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 30500 if mAge == 37
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 33000 if mAge == 38
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 35600 if mAge == 39
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 38100 if mAge == 40
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 39100 if mAge == 41
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 40100 if mAge == 42
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 41100 if mAge == 43
{txt}(29 real changes made)
{com}.         replace `availAssets' = `availAssets' - 42100 if mAge == 44
{txt}(65 real changes made)
{com}.         replace `availAssets' = `availAssets' - 43100 if mAge == 45
{txt}(70 real changes made)
{com}.         replace `availAssets' = `availAssets' - 44200 if mAge == 46
{txt}(84 real changes made)
{com}.         replace `availAssets' = `availAssets' - 45300 if mAge == 47
{txt}(97 real changes made)
{com}.         replace `availAssets' = `availAssets' - 46400 if mAge == 48
{txt}(101 real changes made)
{com}.         replace `availAssets' = `availAssets' - 47600 if mAge == 49
{txt}(98 real changes made)
{com}.         replace `availAssets' = `availAssets' - 48700 if mAge == 50
{txt}(112 real changes made)
{com}.         replace `availAssets' = `availAssets' - 50200 if mAge == 51
{txt}(12 real changes made)
{com}.         replace `availAssets' = `availAssets' - 51500 if mAge == 52
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 53000 if mAge == 53
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 54300 if mAge == 54
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 55900 if mAge == 55
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 57300 if mAge == 56
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 59000 if mAge == 57
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 60700 if mAge == 58
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 62500 if mAge == 59
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 64300 if mAge == 60
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 66200 if mAge == 61
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 68100 if mAge == 62
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 70400 if mAge == 63
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 72400 if mAge == 64
{txt}(0 real changes made)
{com}.         replace `availAssets' = `availAssets' - 74800 if mAge >= 65 & !missing(mAge)
{txt}(0 real changes made)
{com}.         replace `availAssets' = . if missing(mAge)
{txt}(6 real changes made, 6 to missing)
{com}. {c )-}
{txt}
{com}. 
.         display "THIS IS A TEST"
{res}THIS IS A TEST
{txt}
{com}.         
. if !momMarried{c -(}
.         replace `availAssets' = `availAssets' - 0 if mAge <= 25
.         replace `availAssets' = `availAssets' - 1000 if mAge == 26
.         replace `availAssets' = `availAssets' - 2100 if mAge == 27
.         replace `availAssets' = `availAssets' - 3100 if mAge == 28
.         replace `availAssets' = `availAssets' - 4200 if mAge == 29
.         replace `availAssets' = `availAssets' - 5200 if mAge == 30
.         replace `availAssets' = `availAssets' - 6300 if mAge == 31
.         replace `availAssets' = `availAssets' - 7300 if mAge == 32
.         replace `availAssets' = `availAssets' - 8400 if mAge == 33
.         replace `availAssets' = `availAssets' - 9400 if mAge == 34
.         replace `availAssets' = `availAssets' - 10500 if mAge == 35
.         replace `availAssets' = `availAssets' - 11500 if mAge == 36
.         replace `availAssets' = `availAssets' - 12600 if mAge == 37
.         replace `availAssets' = `availAssets' - 13600 if mAge == 38
.         replace `availAssets' = `availAssets' - 14700 if mAge == 39
.         replace `availAssets' = `availAssets' - 15700 if mAge == 40
.         replace `availAssets' = `availAssets' - 16100 if mAge == 41
.         replace `availAssets' = `availAssets' - 16400 if mAge == 42
.         replace `availAssets' = `availAssets' - 16800 if mAge == 43
.         replace `availAssets' = `availAssets' - 17200 if mAge == 44
.         replace `availAssets' = `availAssets' - 17500 if mAge == 45
.         replace `availAssets' = `availAssets' - 17900 if mAge == 46
.         replace `availAssets' = `availAssets' - 18300 if mAge == 47
.         replace `availAssets' = `availAssets' - 18800 if mAge == 48
.         replace `availAssets' = `availAssets' - 19200 if mAge == 49
.         replace `availAssets' = `availAssets' - 19700 if mAge == 50
.         replace `availAssets' = `availAssets' - 20100 if mAge == 51
.         replace `availAssets' = `availAssets' - 20500 if mAge == 52
.         replace `availAssets' = `availAssets' - 21000 if mAge == 53
.         replace `availAssets' = `availAssets' - 21600 if mAge == 54
.         replace `availAssets' = `availAssets' - 22100 if mAge == 55
.         replace `availAssets' = `availAssets' - 22700 if mAge == 56
.         replace `availAssets' = `availAssets' - 23200 if mAge == 57
.         replace `availAssets' = `availAssets' - 23900 if mAge == 58
.         replace `availAssets' = `availAssets' - 24400 if mAge == 59
.         replace `availAssets' = `availAssets' - 25100 if mAge == 60
.         replace `availAssets' = `availAssets' - 25700 if mAge == 61
.         replace `availAssets' = `availAssets' - 26400 if mAge == 62
.         replace `availAssets' = `availAssets' - 27200 if mAge == 63
.         replace `availAssets' = `availAssets' - 27900 if mAge == 64
.         replace `availAssets' = `availAssets' - 28700 if mAge >= 65 & !missing(mAge)
.         replace `availAssets' = . if missing(mAge)
. {c )-}
{txt}
{com}. 
. 
. replace `availAssets' = max(0, 0.12 * `availAssets')
{txt}(950 real changes made)

{com}. 
. 
. //Box 5
. tempvar resources
{txt}
{com}. gen `resources' = `availInc' + `availAssets'
{txt}(195 missing values generated)

{com}. 
. tempvar grossCont
{txt}
{com}. gen `grossCont' = .
{txt}(950 missing values generated)

{com}. replace `grossCont' = -750 if `resources' < -3409
{txt}(107 real changes made)

{com}. replace `grossCont' = .22 * `availInc' if inrange(`resources', -3409, 13400)
{txt}(97 real changes made)

{com}. replace `grossCont' = 2948 + .25 * (`resources' - 13400) if inrange(`resources', 13401, 16800)
{txt}(22 real changes made)

{com}. replace `grossCont' = 3798 + .29 * (`resources' - 16800) if inrange(`resources', 16801, 20200)
{txt}(21 real changes made)

{com}. replace `grossCont' = 4784 + .34 * (`resources' - 20200) if inrange(`resources', 20201, 23700)
{txt}(18 real changes made)

{com}. replace `grossCont' = 5974 + .40 * (`resources' - 23700) if inrange(`resources', 23701, 27100)
{txt}(15 real changes made)

{com}. replace `grossCont' = 7334 + .47 * (`resources' - 27100) if `resources' >= 27101
{txt}(475 real changes made)

{com}. 
. replace `grossCont' = max(`grossCont', 0)
{txt}(324 real changes made)

{com}. 
. gen efc = `grossCont' / sibsInColl
{txt}(645 missing values generated)

{com}. 
. //If stopped at line 3
. replace efc = 0 if parInc < 20000
{txt}(67 real changes made)

{com}. 
. //Need
. gen need = tuition - efc
{txt}(612 missing values generated)

{com}. //replace need = 0 if need < 0
. 
. //Cap dummies
. gen atCap = 0 if !missing(need)
{txt}(612 missing values generated)

{com}. replace atCap = 1 if need >= 5500 & !missing(need)
{txt}(108 real changes made)

{com}. 
. //Drops temp variables (somehow not automatic?)
. drop __*
{txt}
{com}. 
. save ../Output/Need.dta, replace
{txt}file ../Output/Need.dta saved

{com}. 
{txt}end of do-file

{com}. scatter momMarried mAge
{res}
{com}. do "C:\Users\gmoore\Desktop\honors\Analysis\NeedCalc\Code\NeedCalc.do"
{txt}
{com}. use ../Input/Merged.dta, clear
{txt}
{com}. //Available Income Calc
. 
. //Preliminary stats:
. 
. //Household is composed of:
. //Child and mother, plus siblings, plus spouse
. gen hhSize = 2 + sibs + momMarried
{txt}(70 missing values generated)

{com}. 
. //Mother's age
. gen mAge = floor((ym(2008, 1) - parDob) / 12)
{txt}(15 missing values generated)

{com}. 
. //Box 1: Just parInc
. 
. //Box 2: Income Allowances
. tempvar incAllowance
{txt}
{com}. gen `incAllowance' = 0
{txt}
{com}. 
. //Social security allowance
. replace `incAllowance' = `incAllowance' + .0765 * parInc if parInc < 94200
{txt}(476 real changes made)

{com}. replace `incAllowance' = `incAllowance' + 7206.3 + 0.145 * (parInc - 94200) if parInc >= 94200
{txt}(465 real changes made, 195 to missing)

{com}. 
. //Income protection (line 12), aka table A3
. //Assumes parents are not also in college
. if hhSize == 2{c -(}
.         replace `incAllowance' = `incAllowance' + 15000
. {c )-}
{txt}
{com}. else if hhSize == 3{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 18680
.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 16130
.         {c )-}
. {c )-}
{txt}
{com}. else if hhSize == 4{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 23070
{txt}(755 real changes made)
{com}.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 20510
.         {c )-}
.         else if sibsInCollege == 2{c -(}
.                 replace `incAllowance' = `incAllowance' + 17950
.         {c )-}
. {c )-}
{txt}
{com}. else if hhSize == 5{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 27220
.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 24660
.         {c )-}
.         else if sibsInCollege == 2{c -(}
.                 replace `incAllowance' = `incAllowance' + 22100
.         {c )-}
.         else if sibsInCollege == 3{c -(}
.                 replace `incAllowance' = `incAllowance' + 19540
.         {c )-}
.         else if sibsInCollege == 4{c -(}
.                 replace `incAllowance' = `incAllowance' + 16980
.         {c )-}
. {c )-}
{txt}
{com}. else if hhSize >= 6{c -(}
.         if sibsInCollege == 0{c -(}
.                 replace `incAllowance' = `incAllowance' + 31840
.         {c )-}
.         else if sibsInCollege == 1{c -(}
.                 replace `incAllowance' = `incAllowance' + 29280
.         {c )-}
.         else if sibsInCollege == 2{c -(}
.                 replace `incAllowance' = `incAllowance' + 26720
.         {c )-}
.         else if sibsInCollege == 3{c -(}
.                 replace `incAllowance' = `incAllowance' + 24160
.         {c )-}
.         else if sibsInCollege == 4{c -(}
.                 replace `incAllowance' = `incAllowance' + 21600
.         {c )-}
.         else if sibsInCollege == 5{c -(}
.                 replace `incAllowance' = `incAllowance' + 21600 - 2550
.         {c )-}
.         else if sibsInCollege >= 6{c -(}
.                 replace `incAllowance' = 21600 - (sibsInCollege - 6) * 2550
.         {c )-}
.         `incAllowance' = `incAllowance' + (hhSize - 6) * 3590
. {c )-}
{txt}
{com}. 
. //Single-parent deducation (line 13)
. replace `incAllowance' = `incAllowance' + min(3200, .35 * parInc) if !momMarried
{txt}(241 real changes made)

{com}. 
. 
. //Box 3
. tempvar availInc
{txt}
{com}. gen `availInc' = parInc - `incAllowance'
{txt}(195 missing values generated)

{com}. 
. 
. //Box 4
. tempvar availAssets
{txt}
{com}. gen `availAssets' = assets - homeVal
{txt}(267 missing values generated)

{com}. //Table A5
. replace `availAssets' = . if missing(momMarried)
{txt}(9 real changes made, 9 to missing)

{com}. 
. replace `availAssets' = `availAssets' - 0 if mAge <= 25 & momMarried & !missing(momMarried)
{txt}(0 real changes made)

{com}. replace `availAssets' = `availAssets' - 2500 if mAge == 26 & momMarried & !missing(momMarried)
{txt}(0 real changes made)

{com}. replace `availAssets' = `availAssets' - 5100 if mAge == 27 & momMarried & !missing(momMarried)
{txt}(0 real changes made)

{com}. replace `availAssets' = `availAssets' - 7600 if mAge == 28 & momMarried & !missing(momMarried)
{txt}(0 real changes made)

{com}. replace `availAssets' = `availAssets' - 10200 if mAge == 29 & momMarried & !missing(momMarried)
{txt}(0 real changes made)

{com}. replace `availAssets' = `availAssets' - 12700 if mAge == 30 & momMarried & !missing(momMarried)
{txt}(0 real changes made)

{com}. replace `availAssets' = `availAssets' - 15200 if mAge == 31 & momMarried & !missing(momMarried)
{txt}(0 real changes made)

{com}. replace `availAssets' = `availAssets' - 17800 if mAge == 32 & momMarried & !missing(momMarried)
{txt}(0 real changes made)

{com}. replace `availAssets' = `availAssets' - 20300 if mAge == 33 & momMarried & !missing(momMarried)
{txt}(0 real changes made)

{com}. replace `availAssets' = `availAssets' - 22900 if mAge == 34 & momMarried & !missing(momMarried)
{txt}(0 real changes made)

{com}. replace `availAssets' = `availAssets' - 25400 if mAge == 35 & momMarried & !missing(momMarried)
{txt}(0 real changes made)

{com}. replace `availAssets' = `availAssets' - 27900 if mAge == 36 & momMarried & !missing(momMarried)
{txt}(0 real changes made)

{com}. replace `availAssets' = `availAssets' - 30500 if mAge == 37 & momMarried & !missing(momMarried)
{txt}(0 real changes made)

{com}. replace `availAssets' = `availAssets' - 33000 if mAge == 38 & momMarried & !missing(momMarried)
{txt}(0 real changes made)

{com}. replace `availAssets' = `availAssets' - 35600 if mAge == 39 & momMarried & !missing(momMarried)
{txt}(0 real changes made)

{com}. replace `availAssets' = `availAssets' - 38100 if mAge == 40 & momMarried & !missing(momMarried)
{txt}(0 real changes made)

{com}. replace `availAssets' = `availAssets' - 39100 if mAge == 41 & momMarried & !missing(momMarried)
{txt}(0 real changes made)

{com}. replace `availAssets' = `availAssets' - 40100 if mAge == 42 & momMarried & !missing(momMarried)
{txt}(0 real changes made)

{com}. replace `availAssets' = `availAssets' - 41100 if mAge == 43 & momMarried & !missing(momMarried)
{txt}(14 real changes made)

{com}. replace `availAssets' = `availAssets' - 42100 if mAge == 44 & momMarried & !missing(momMarried)
{txt}(31 real changes made)

{com}. replace `availAssets' = `availAssets' - 43100 if mAge == 45 & momMarried & !missing(momMarried)
{txt}(42 real changes made)

{com}. replace `availAssets' = `availAssets' - 44200 if mAge == 46 & momMarried & !missing(momMarried)
{txt}(63 real changes made)

{com}. replace `availAssets' = `availAssets' - 45300 if mAge == 47 & momMarried & !missing(momMarried)
{txt}(60 real changes made)

{com}. replace `availAssets' = `availAssets' - 46400 if mAge == 48 & momMarried & !missing(momMarried)
{txt}(70 real changes made)

{com}. replace `availAssets' = `availAssets' - 47600 if mAge == 49 & momMarried & !missing(momMarried)
{txt}(72 real changes made)

{com}. replace `availAssets' = `availAssets' - 48700 if mAge == 50 & momMarried & !missing(momMarried)
{txt}(77 real changes made)

{com}. replace `availAssets' = `availAssets' - 50200 if mAge == 51 & momMarried & !missing(momMarried)
{txt}(9 real changes made)

{com}. replace `availAssets' = `availAssets' - 51500 if mAge == 52 & momMarried & !missing(momMarried)
{txt}(0 real changes made)

{com}. replace `availAssets' = `availAssets' - 53000 if mAge == 53 & momMarried & !missing(momMarried)
{txt}(0 real changes made)

{com}. replace `availAssets' = `availAssets' - 54300 if mAge == 54 & momMarried & !missing(momMarried)
{txt}(0 real changes made)

{com}. replace `availAssets' = `availAssets' - 55900 if mAge == 55 & momMarried & !missing(momMarried)
{txt}(0 real changes made)

{com}. replace `availAssets' = `availAssets' - 57300 if mAge == 56 & momMarried & !missing(momMarried)
{txt}(0 real changes made)

{com}. replace `availAssets' = `availAssets' - 59000 if mAge == 57 & momMarried & !missing(momMarried)
{txt}(0 real changes made)

{com}. replace `availAssets' = `availAssets' - 60700 if mAge == 58 & momMarried & !missing(momMarried)
{txt}(0 real changes made)

{com}. replace `availAssets' = `availAssets' - 62500 if mAge == 59 & momMarried & !missing(momMarried)
{txt}(0 real changes made)

{com}. replace `availAssets' = `availAssets' - 64300 if mAge == 60 & momMarried & !missing(momMarried)
{txt}(0 real changes made)

{com}. replace `availAssets' = `availAssets' - 66200 if mAge == 61 & momMarried & !missing(momMarried)
{txt}(0 real changes made)

{com}. replace `availAssets' = `availAssets' - 68100 if mAge == 62 & momMarried & !missing(momMarried)
{txt}(0 real changes made)

{com}. replace `availAssets' = `availAssets' - 70400 if mAge == 63 & momMarried & !missing(momMarried)
{txt}(0 real changes made)

{com}. replace `availAssets' = `availAssets' - 72400 if mAge == 64 & momMarried & !missing(momMarried)
{txt}(0 real changes made)

{com}. replace `availAssets' = `availAssets' - 74800 if mAge >= 65 & !missing(mAge) & momMarried & !missing(momMarried)
{txt}(0 real changes made)

{com}. replace `availAssets' = . if missing(mAge)
{txt}(6 real changes made, 6 to missing)

{com}.         
. if !momMarried{c -(}
.         replace `availAssets' = `availAssets' - 0 if mAge <= 25
.         replace `availAssets' = `availAssets' - 1000 if mAge == 26
.         replace `availAssets' = `availAssets' - 2100 if mAge == 27
.         replace `availAssets' = `availAssets' - 3100 if mAge == 28
.         replace `availAssets' = `availAssets' - 4200 if mAge == 29
.         replace `availAssets' = `availAssets' - 5200 if mAge == 30
.         replace `availAssets' = `availAssets' - 6300 if mAge == 31
.         replace `availAssets' = `availAssets' - 7300 if mAge == 32
.         replace `availAssets' = `availAssets' - 8400 if mAge == 33
.         replace `availAssets' = `availAssets' - 9400 if mAge == 34
.         replace `availAssets' = `availAssets' - 10500 if mAge == 35
.         replace `availAssets' = `availAssets' - 11500 if mAge == 36
.         replace `availAssets' = `availAssets' - 12600 if mAge == 37
.         replace `availAssets' = `availAssets' - 13600 if mAge == 38
.         replace `availAssets' = `availAssets' - 14700 if mAge == 39
.         replace `availAssets' = `availAssets' - 15700 if mAge == 40
.         replace `availAssets' = `availAssets' - 16100 if mAge == 41
.         replace `availAssets' = `availAssets' - 16400 if mAge == 42
.         replace `availAssets' = `availAssets' - 16800 if mAge == 43
.         replace `availAssets' = `availAssets' - 17200 if mAge == 44
.         replace `availAssets' = `availAssets' - 17500 if mAge == 45
.         replace `availAssets' = `availAssets' - 17900 if mAge == 46
.         replace `availAssets' = `availAssets' - 18300 if mAge == 47
.         replace `availAssets' = `availAssets' - 18800 if mAge == 48
.         replace `availAssets' = `availAssets' - 19200 if mAge == 49
.         replace `availAssets' = `availAssets' - 19700 if mAge == 50
.         replace `availAssets' = `availAssets' - 20100 if mAge == 51
.         replace `availAssets' = `availAssets' - 20500 if mAge == 52
.         replace `availAssets' = `availAssets' - 21000 if mAge == 53
.         replace `availAssets' = `availAssets' - 21600 if mAge == 54
.         replace `availAssets' = `availAssets' - 22100 if mAge == 55
.         replace `availAssets' = `availAssets' - 22700 if mAge == 56
.         replace `availAssets' = `availAssets' - 23200 if mAge == 57
.         replace `availAssets' = `availAssets' - 23900 if mAge == 58
.         replace `availAssets' = `availAssets' - 24400 if mAge == 59
.         replace `availAssets' = `availAssets' - 25100 if mAge == 60
.         replace `availAssets' = `availAssets' - 25700 if mAge == 61
.         replace `availAssets' = `availAssets' - 26400 if mAge == 62
.         replace `availAssets' = `availAssets' - 27200 if mAge == 63
.         replace `availAssets' = `availAssets' - 27900 if mAge == 64
.         replace `availAssets' = `availAssets' - 28700 if mAge >= 65 & !missing(mAge)
.         replace `availAssets' = . if missing(mAge)
. {c )-}
{txt}
{com}. 
. 
. replace `availAssets' = max(0, 0.12 * `availAssets')
{txt}(931 real changes made)

{com}. 
. 
. //Box 5
. tempvar resources
{txt}
{com}. gen `resources' = `availInc' + `availAssets'
{txt}(195 missing values generated)

{com}. 
. tempvar grossCont
{txt}
{com}. gen `grossCont' = .
{txt}(950 missing values generated)

{com}. replace `grossCont' = -750 if `resources' < -3409
{txt}(104 real changes made)

{com}. replace `grossCont' = .22 * `availInc' if inrange(`resources', -3409, 13400)
{txt}(96 real changes made)

{com}. replace `grossCont' = 2948 + .25 * (`resources' - 13400) if inrange(`resources', 13401, 16800)
{txt}(24 real changes made)

{com}. replace `grossCont' = 3798 + .29 * (`resources' - 16800) if inrange(`resources', 16801, 20200)
{txt}(21 real changes made)

{com}. replace `grossCont' = 4784 + .34 * (`resources' - 20200) if inrange(`resources', 20201, 23700)
{txt}(18 real changes made)

{com}. replace `grossCont' = 5974 + .40 * (`resources' - 23700) if inrange(`resources', 23701, 27100)
{txt}(14 real changes made)

{com}. replace `grossCont' = 7334 + .47 * (`resources' - 27100) if `resources' >= 27101
{txt}(478 real changes made)

{com}. 
. replace `grossCont' = max(`grossCont', 0)
{txt}(324 real changes made)

{com}. 
. gen efc = `grossCont' / sibsInColl
{txt}(645 missing values generated)

{com}. 
. //If stopped at line 3
. replace efc = 0 if parInc < 20000
{txt}(67 real changes made)

{com}. 
. //Need
. gen need = tuition - efc
{txt}(612 missing values generated)

{com}. //replace need = 0 if need < 0
. 
. //Cap dummies
. gen atCap = 0 if !missing(need)
{txt}(612 missing values generated)

{com}. replace atCap = 1 if need >= 5500 & !missing(need)
{txt}(108 real changes made)

{com}. 
. //Drops temp variables (somehow not automatic?)
. drop __*
{txt}
{com}. 
. save ../Output/Need.dta, replace
{txt}file ../Output/Need.dta saved

{com}. 
{txt}end of do-file

{com}. 